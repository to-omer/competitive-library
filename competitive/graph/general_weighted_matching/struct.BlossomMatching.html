<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `BlossomMatching` struct in crate `competitive`."><title>BlossomMatching in competitive::graph::general_weighted_matching - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-77263533.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="competitive" data-themes="" data-resource-suffix="" data-rustdoc-version="1.94.0-nightly (f57eac1bf 2026-01-10)" data-channel="nightly" data-search-js="search-9e2438ea.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-7bab91a1.js"></script><script defer src="../../../static.files/scrape-examples-2bbcccac.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-ffcac47a.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ]
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const parser = new DOMParser();
    const parse = s => parser.parseFromString(s, "text/html").body.firstChild;

    const addArchiveLinkSetting = () => {
      const settings = document.querySelector("#settings .settings");
      if (!settings) return;
      if (document.getElementById("generate-hidden-archive-link")) return;

      const checked = localStorage.getItem("generate-hidden-archive-link") === "true";
      const archiveLinkSetting = parse(`<div class="setting-line"><label class="setting-check"><input type="checkbox" id="generate-hidden-archive-link" ${checked ? "checked" : ""} /><span>Generate hidden archive link</span></label></div>`);
      settings.appendChild(archiveLinkSetting);
      document.getElementById("generate-hidden-archive-link").addEventListener("change", e => {
        if (e.target.checked) {
          localStorage.setItem("generate-hidden-archive-link", "true");
        } else {
          localStorage.removeItem("generate-hidden-archive-link");
        }
      });
    };
    addArchiveLinkSetting();
    const settingsMenu = document.querySelector("#settings-menu a");
    settingsMenu?.addEventListener("click", addArchiveLinkSetting);

    const addArchiveLink = () => {
      if (localStorage.getItem("generate-hidden-archive-link") !== "true") return;
      const subHeading = document.querySelector("#main-content .main-heading .sub-heading");
      const itemName = document.querySelector("#main-content .main-heading h1 span")?.textContent;
      const isCompetitive = document.querySelector("#main-content .main-heading .rustdoc-breadcrumbs a")?.textContent?.startsWith("competitive");
      if (!itemName || !isCompetitive) return;
      const archiveLink = parse(`<a class="src" href="https://github.com/search?q=repo%3Ato-omer%2Fcompetitive_archive+${itemName}&type=code">Archives</a>`);
      subHeading.appendChild(archiveLink);
    };
    addArchiveLink();
  });
</script>

</head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">BlossomMatching</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../competitive/index.html">competitive</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Blossom<wbr>Matching</a></h2><h3><a href="#fields">Fields</a></h3><ul class="block structfield"><li><a href="#structfield.allowedge" title="allowedge">allowedge</a></li><li><a href="#structfield.bestedge" title="bestedge">bestedge</a></li><li><a href="#structfield.blossombase" title="blossombase">blossombase</a></li><li><a href="#structfield.blossombestedges" title="blossombestedges">blossombestedges</a></li><li><a href="#structfield.blossomchilds" title="blossomchilds">blossomchilds</a></li><li><a href="#structfield.blossomendps" title="blossomendps">blossomendps</a></li><li><a href="#structfield.blossomparent" title="blossomparent">blossomparent</a></li><li><a href="#structfield.dualvar" title="dualvar">dualvar</a></li><li><a href="#structfield.endpoint" title="endpoint">endpoint</a></li><li><a href="#structfield.inblossom" title="inblossom">inblossom</a></li><li><a href="#structfield.label" title="label">label</a></li><li><a href="#structfield.labelend" title="labelend">labelend</a></li><li><a href="#structfield.mate" title="mate">mate</a></li><li><a href="#structfield.n" title="n">n</a></li><li><a href="#structfield.neighbend" title="neighbend">neighbend</a></li><li><a href="#structfield.queue" title="queue">queue</a></li><li><a href="#structfield.unusedblossoms" title="unusedblossoms">unusedblossoms</a></li><li><a href="#structfield.weight" title="weight">weight</a></li></ul><h3><a href="#implementations">Methods</a></h3><ul class="block method"><li><a href="#method.add_blossom" title="add_blossom">add_blossom</a></li><li><a href="#method.assign_label" title="assign_label">assign_label</a></li><li><a href="#method.augment_blossom" title="augment_blossom">augment_blossom</a></li><li><a href="#method.augment_matching" title="augment_matching">augment_matching</a></li><li><a href="#method.blossom_leaves" title="blossom_leaves">blossom_leaves</a></li><li><a href="#method.dec_index" title="dec_index">dec_index</a></li><li><a href="#method.expand_blossom" title="expand_blossom">expand_blossom</a></li><li><a href="#method.new" title="new">new</a></li><li><a href="#method.scan_blossom" title="scan_blossom">scan_blossom</a></li><li><a href="#method.slack" title="slack">slack</a></li><li><a href="#method.solve" title="solve">solve</a></li><li><a href="#method.step_index" title="step_index">step_index</a></li></ul><h3><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul class="block synthetic-implementation"><li><a href="#impl-Freeze-for-BlossomMatching" title="Freeze">Freeze</a></li><li><a href="#impl-RefUnwindSafe-for-BlossomMatching" title="RefUnwindSafe">RefUnwindSafe</a></li><li><a href="#impl-Send-for-BlossomMatching" title="Send">Send</a></li><li><a href="#impl-Sync-for-BlossomMatching" title="Sync">Sync</a></li><li><a href="#impl-Unpin-for-BlossomMatching" title="Unpin">Unpin</a></li><li><a href="#impl-UnwindSafe-for-BlossomMatching" title="UnwindSafe">UnwindSafe</a></li></ul><h3><a href="#blanket-implementations">Blanket Implementations</a></h3><ul class="block blanket-implementation"><li><a href="#impl-Any-for-T" title="Any">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-T" title="Borrow&#60;T&#62;">Borrow&#60;T&#62;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-T" title="BorrowMut&#60;T&#62;">BorrowMut&#60;T&#62;</a></li><li><a href="#impl-From%3CT%3E-for-T" title="From&#60;T&#62;">From&#60;T&#62;</a></li><li><a href="#impl-Into%3CU%3E-for-T" title="Into&#60;U&#62;">Into&#60;U&#62;</a></li><li><a href="#impl-TryFrom%3CU%3E-for-T" title="TryFrom&#60;U&#62;">TryFrom&#60;U&#62;</a></li><li><a href="#impl-TryInto%3CU%3E-for-T" title="TryInto&#60;U&#62;">TryInto&#60;U&#62;</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In competitive::<wbr>graph::<wbr>general_<wbr>weighted_<wbr>matching</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">competitive</a>::<wbr><a href="../index.html">graph</a>::<wbr><a href="index.html">general_weighted_matching</a></div><h1>Struct <span class="struct">Blossom<wbr>Matching</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/competitive/graph/general_weighted_matching.rs.html#98-117">Source</a> </span></div><pre class="rust item-decl"><code>struct BlossomMatching {<details class="toggle type-contents-toggle"><summary class="hideme"><span>Show 18 fields</span></summary>
    n: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>,
    endpoint: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    weight: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a>&gt;,
    neighbend: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;,
    mate: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    label: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a>&gt;,
    labelend: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    inblossom: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    blossomparent: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    blossomchilds: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;,
    blossombase: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    blossomendps: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;,
    bestedge: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    blossombestedges: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;,
    unusedblossoms: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    dualvar: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a>&gt;,
    allowedge: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>&gt;,
    queue: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
</details>}</code></pre><h2 id="fields" class="fields section-header">Fields<a href="#fields" class="anchor">§</a></h2><span id="structfield.n" class="structfield section-header"><a href="#structfield.n" class="anchor field">§</a><code>n: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code></span><span id="structfield.endpoint" class="structfield section-header"><a href="#structfield.endpoint" class="anchor field">§</a><code>endpoint: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.weight" class="structfield section-header"><a href="#structfield.weight" class="anchor field">§</a><code>weight: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a>&gt;</code></span><span id="structfield.neighbend" class="structfield section-header"><a href="#structfield.neighbend" class="anchor field">§</a><code>neighbend: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;</code></span><span id="structfield.mate" class="structfield section-header"><a href="#structfield.mate" class="anchor field">§</a><code>mate: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.label" class="structfield section-header"><a href="#structfield.label" class="anchor field">§</a><code>label: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a>&gt;</code></span><span id="structfield.labelend" class="structfield section-header"><a href="#structfield.labelend" class="anchor field">§</a><code>labelend: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.inblossom" class="structfield section-header"><a href="#structfield.inblossom" class="anchor field">§</a><code>inblossom: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.blossomparent" class="structfield section-header"><a href="#structfield.blossomparent" class="anchor field">§</a><code>blossomparent: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.blossomchilds" class="structfield section-header"><a href="#structfield.blossomchilds" class="anchor field">§</a><code>blossomchilds: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;</code></span><span id="structfield.blossombase" class="structfield section-header"><a href="#structfield.blossombase" class="anchor field">§</a><code>blossombase: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.blossomendps" class="structfield section-header"><a href="#structfield.blossomendps" class="anchor field">§</a><code>blossomendps: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;</code></span><span id="structfield.bestedge" class="structfield section-header"><a href="#structfield.bestedge" class="anchor field">§</a><code>bestedge: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.blossombestedges" class="structfield section-header"><a href="#structfield.blossombestedges" class="anchor field">§</a><code>blossombestedges: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;</code></span><span id="structfield.unusedblossoms" class="structfield section-header"><a href="#structfield.unusedblossoms" class="anchor field">§</a><code>unusedblossoms: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><span id="structfield.dualvar" class="structfield section-header"><a href="#structfield.dualvar" class="anchor field">§</a><code>dualvar: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a>&gt;</code></span><span id="structfield.allowedge" class="structfield section-header"><a href="#structfield.allowedge" class="anchor field">§</a><code>allowedge: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>&gt;</code></span><span id="structfield.queue" class="structfield section-header"><a href="#structfield.queue" class="anchor field">§</a><code>queue: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</code></span><h2 id="implementations" class="section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-BlossomMatching" class="impl"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#119-707">Source</a><a href="#impl-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.new" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#120-169">Source</a><h4 class="code-header">fn <a href="#method.new" class="fn">new</a>(
    n: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>,
    endpoint: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;,
    weight: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a>&gt;,
    neighbend: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;&gt;,
) -&gt; Self</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples"><a href="#scraped-examples">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[32,32],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#82&#34;,&#34;line 82&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#82">line 82</a>)</div><div class="example-wrap digits-2"><pre class="rust"><code><span data-nosnippet>50</span>    <span class="kw">fn </span>compute(<span class="kw-2">&amp;mut </span><span class="self">self</span>) {
<span data-nosnippet>51</span>        <span class="kw">if </span><span class="self">self</span>.<span class="macro">matching_weight !</span>= NEG_INF {
<span data-nosnippet>52</span>            <span class="kw">return</span>;
<span data-nosnippet>53</span>        }
<span data-nosnippet>54</span>        <span class="kw">let </span>n = <span class="self">self</span>.size;
<span data-nosnippet>55</span>        <span class="kw">if </span>n == <span class="number">0 </span>{
<span data-nosnippet>56</span>            <span class="self">self</span>.matching_weight = <span class="number">0</span>;
<span data-nosnippet>57</span>            <span class="kw">return</span>;
<span data-nosnippet>58</span>        }
<span data-nosnippet>59</span>        <span class="kw">let </span><span class="kw-2">mut </span>edges = Vec::new();
<span data-nosnippet>60</span>        <span class="kw">let </span><span class="kw-2">mut </span>weights = Vec::new();
<span data-nosnippet>61</span>        <span class="kw">let </span><span class="kw-2">mut </span>neighbend = <span class="macro">vec!</span>[Vec::new(); n];
<span data-nosnippet>62</span>        <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..n {
<span data-nosnippet>63</span>            <span class="kw">for </span>j <span class="kw">in </span>i + <span class="number">1</span>..n {
<span data-nosnippet>64</span>                <span class="kw">let </span>w = <span class="self">self</span>.weight[i][j];
<span data-nosnippet>65</span>                <span class="kw">if </span>w == NEG_INF {
<span data-nosnippet>66</span>                    <span class="kw">continue</span>;
<span data-nosnippet>67</span>                }
<span data-nosnippet>68</span>                <span class="kw">let </span>k = weights.len();
<span data-nosnippet>69</span>                weights.push(w);
<span data-nosnippet>70</span>                edges.push(i);
<span data-nosnippet>71</span>                edges.push(j);
<span data-nosnippet>72</span>                neighbend[i].push(<span class="number">2 </span>* k + <span class="number">1</span>);
<span data-nosnippet>73</span>                neighbend[j].push(<span class="number">2 </span>* k);
<span data-nosnippet>74</span>            }
<span data-nosnippet>75</span>        }
<span data-nosnippet>76</span>        <span class="kw">let </span>m = weights.len();
<span data-nosnippet>77</span>        <span class="kw">if </span>m == <span class="number">0 </span>{
<span data-nosnippet>78</span>            <span class="self">self</span>.mate.fill(!<span class="number">0</span>);
<span data-nosnippet>79</span>            <span class="self">self</span>.matching_weight = <span class="number">0</span>;
<span data-nosnippet>80</span>            <span class="kw">return</span>;
<span data-nosnippet>81</span>        }
<span data-nosnippet>82</span>        <span class="kw">let </span><span class="kw-2">mut </span>blossom = <span class="highlight focus">BlossomMatching::new</span>(n, edges, weights, neighbend);
<span data-nosnippet>83</span>        blossom.solve(<span class="bool-val">false</span>);
<span data-nosnippet>84</span>        <span class="self">self</span>.mate.fill(!<span class="number">0</span>);
<span data-nosnippet>85</span>        <span class="kw">let </span><span class="kw-2">mut </span>total = <span class="number">0i64</span>;
<span data-nosnippet>86</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..n {
<span data-nosnippet>87</span>            <span class="kw">let </span>u = blossom.mate[v];
<span data-nosnippet>88</span>            <span class="kw">if </span><span class="macro">u !</span>= !<span class="number">0 </span>&amp;&amp; v &lt; u {
<span data-nosnippet>89</span>                <span class="self">self</span>.mate[v] = u;
<span data-nosnippet>90</span>                <span class="self">self</span>.mate[u] = v;
<span data-nosnippet>91</span>                total += <span class="self">self</span>.weight[v][u];
<span data-nosnippet>92</span>            }
<span data-nosnippet>93</span>        }
<span data-nosnippet>94</span>        <span class="self">self</span>.matching_weight = total;
<span data-nosnippet>95</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.slack" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#171-175">Source</a><h4 class="code-header">fn <a href="#method.slack" class="fn">slack</a>(&amp;self, k: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i64.html">i64</a></h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-1"><a href="#scraped-examples-1">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[75,75],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#319&#34;,&#34;line 319&#34;],[[75,75],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#319&#34;,&#34;line 319&#34;],[[92,92],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#336&#34;,&#34;line 336&#34;],[[92,92],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#336&#34;,&#34;line 336&#34;],[[321,321],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#565&#34;,&#34;line 565&#34;],[[344,344],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#588&#34;,&#34;line 588&#34;],[[348,348],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#592&#34;,&#34;line 592&#34;],[[370,370],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#614&#34;,&#34;line 614&#34;],[[380,380],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#624&#34;,&#34;line 624&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#319">line 319</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>244</span>    <span class="kw">fn </span>add_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, base: usize, k: usize) {
<span data-nosnippet>245</span>        <span class="kw">let </span><span class="kw-2">mut </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>246</span>        <span class="kw">let </span><span class="kw-2">mut </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>247</span>        <span class="kw">let </span>bb = <span class="self">self</span>.inblossom[base];
<span data-nosnippet>248</span>        <span class="kw">let </span><span class="kw-2">mut </span>bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>249</span>        <span class="kw">let </span><span class="kw-2">mut </span>bw = <span class="self">self</span>.<a href="https://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html">inblossom</a>[w];
<span data-nosnippet>250</span>        <span class="kw">let </span>b = <span class="self">self</span>.unusedblossoms.pop().unwrap();
<span data-nosnippet>251</span>        <span class="self">self</span>.blossombase[b] = base;
<span data-nosnippet>252</span>        <span class="self">self</span>.blossomparent[b] = !<span class="number">0</span>;
<span data-nosnippet>253</span>        <span class="self">self</span>.blossomparent[bb] = b;
<span data-nosnippet>254</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>255</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>256</span>        <span class="kw">let </span><span class="kw-2">mut </span>path: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>257</span>        <span class="kw">let </span><span class="kw-2">mut </span>endps: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>258</span>        <span class="kw">while </span><span class="macro">bv !</span>= bb {
<span data-nosnippet>259</span>            <span class="self">self</span>.blossomparent[bv] = b;
<span data-nosnippet>260</span>            path.push(bv);
<span data-nosnippet>261</span>            endps.push(<span class="self">self</span>.labelend[bv]);
<span data-nosnippet>262</span>            v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bv]];
<span data-nosnippet>263</span>            bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>264</span>        }
<span data-nosnippet>265</span>        path.push(bb);
<span data-nosnippet>266</span>        path.reverse();
<span data-nosnippet>267</span>        <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>268</span>        endps.reverse();
<span data-nosnippet>269</span>        endps.push(<span class="number">2 </span>* k);
<span data-nosnippet>270</span>        <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>271</span>        <span class="kw">while </span><span class="macro">bw !</span>= bb {
<span data-nosnippet>272</span>            <span class="self">self</span>.blossomparent[bw] = b;
<span data-nosnippet>273</span>            path.push(bw);
<span data-nosnippet>274</span>            <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>275</span>            endps.push(<span class="self">self</span>.labelend[bw] ^ <span class="number">1</span>);
<span data-nosnippet>276</span>            <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>277</span>            w = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bw]];
<span data-nosnippet>278</span>            bw = <span class="self">self</span>.inblossom[w];
<span data-nosnippet>279</span>        }
<span data-nosnippet>280</span>        <span class="self">self</span>.label[b] = <span class="number">1</span>;
<span data-nosnippet>281</span>        <span class="self">self</span>.labelend[b] = <span class="self">self</span>.labelend[bb];
<span data-nosnippet>282</span>        <span class="self">self</span>.dualvar[b] = <span class="number">0</span>;
<span data-nosnippet>283</span>        <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>284</span>        <span class="self">self</span>.blossom_leaves(b, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>285</span>        <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>286</span>            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>287</span>                <span class="self">self</span>.queue.push(v);
<span data-nosnippet>288</span>            }
<span data-nosnippet>289</span>            <span class="self">self</span>.inblossom[v] = b;
<span data-nosnippet>290</span>        }
<span data-nosnippet>291</span>        <span class="kw">let </span><span class="kw-2">mut </span>bestedgeto = <span class="macro">vec!</span>[!<span class="number">0</span>; <span class="number">2 </span>* <span class="self">self</span>.n];
<span data-nosnippet>292</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>bv <span class="kw">in </span><span class="kw-2">&amp;</span>path {
<span data-nosnippet>293</span>            <span class="kw">let </span>nblists: Vec&lt;Vec&lt;usize&gt;&gt; = <span class="kw">if </span><span class="self">self</span>.blossombestedges[bv].is_empty() {
<span data-nosnippet>294</span>                <span class="kw">let </span><span class="kw-2">mut </span>lists = Vec::new();
<span data-nosnippet>295</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>296</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>297</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>298</span>                    <span class="kw">let </span><span class="kw-2">mut </span>list = Vec::new();
<span data-nosnippet>299</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>300</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>301</span>                        list.push(p / <span class="number">2</span>);
<span data-nosnippet>302</span>                    }
<span data-nosnippet>303</span>                    lists.push(list);
<span data-nosnippet>304</span>                }
<span data-nosnippet>305</span>                lists
<span data-nosnippet>306</span>            } <span class="kw">else </span>{
<span data-nosnippet>307</span>                <span class="macro">vec!</span>[<span class="self">self</span>.blossombestedges[bv].clone()]
<span data-nosnippet>308</span>            };
<span data-nosnippet>309</span>            <span class="kw">for </span>nblist <span class="kw">in </span>nblists {
<span data-nosnippet>310</span>                <span class="kw">for </span>k <span class="kw">in </span>nblist {
<span data-nosnippet>311</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>312</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>313</span>                    <span class="kw">if </span><span class="self">self</span>.inblossom[j] == b {
<span data-nosnippet>314</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>315</span>                    }
<span data-nosnippet>316</span>                    <span class="kw">let </span>bj = <span class="self">self</span>.inblossom[j];
<span data-nosnippet>317</span>                    <span class="kw">if </span><span class="macro">bj !</span>= b
<span data-nosnippet>318</span>                        &amp;&amp; <span class="self">self</span>.label[bj] == <span class="number">1
<span data-nosnippet>319</span>                        </span>&amp;&amp; (bestedgeto[bj] == !<span class="number">0 </span>|| <span class="self">self</span>.<span class="highlight focus">slack</span>(k) &lt; <span class="self">self</span>.<span class="highlight">slack</span>(bestedgeto[bj]))
<span data-nosnippet>320</span>                    {
<span data-nosnippet>321</span>                        bestedgeto[bj] = k;
<span data-nosnippet>322</span>                    }
<span data-nosnippet>323</span>                }
<span data-nosnippet>324</span>            }
<span data-nosnippet>325</span>            <span class="self">self</span>.blossombestedges[bv].clear();
<span data-nosnippet>326</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>327</span>        }
<span data-nosnippet>328</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>329</span>        <span class="kw">for </span>k <span class="kw">in </span>bestedgeto {
<span data-nosnippet>330</span>            <span class="kw">if </span><span class="macro">k !</span>= !<span class="number">0 </span>{
<span data-nosnippet>331</span>                <span class="self">self</span>.blossombestedges[b].push(k);
<span data-nosnippet>332</span>            }
<span data-nosnippet>333</span>        }
<span data-nosnippet>334</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>335</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>k <span class="kw">in </span><span class="kw-2">&amp;</span><span class="self">self</span>.blossombestedges[b] {
<span data-nosnippet>336</span>            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| <span class="self">self</span>.<span class="highlight">slack</span>(k) &lt; <span class="self">self</span>.<span class="highlight">slack</span>(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>337</span>                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>338</span>            }
<span data-nosnippet>339</span>        }
<span data-nosnippet>340</span>    }
<span data-nosnippet>341</span>
<span data-nosnippet>342</span>    <span class="kw">fn </span>step_index(len: usize, j: usize, forward: bool) -&gt; usize {
<span data-nosnippet>343</span>        <span class="kw">if </span>forward {
<span data-nosnippet>344</span>            <span class="kw">let </span>next = j + <span class="number">1</span>;
<span data-nosnippet>345</span>            <span class="kw">if </span>next == len { <span class="number">0 </span>} <span class="kw">else </span>{ next }
<span data-nosnippet>346</span>        } <span class="kw">else if </span>j == <span class="number">0 </span>{
<span data-nosnippet>347</span>            len - <span class="number">1
<span data-nosnippet>348</span>        </span>} <span class="kw">else </span>{
<span data-nosnippet>349</span>            j - <span class="number">1
<span data-nosnippet>350</span>        </span>}
<span data-nosnippet>351</span>    }
<span data-nosnippet>352</span>
<span data-nosnippet>353</span>    <span class="kw">fn </span>dec_index(len: usize, j: usize) -&gt; usize {
<span data-nosnippet>354</span>        <span class="kw">if </span>j == <span class="number">0 </span>{ len - <span class="number">1 </span>} <span class="kw">else </span>{ j - <span class="number">1 </span>}
<span data-nosnippet>355</span>    }
<span data-nosnippet>356</span>
<span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.expand_blossom(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.blossom_leaves(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.assign_label(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.assign_label(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }
<span data-nosnippet>458</span>
<span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.augment_blossom(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.augment_blossom(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.augment_blossom(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }
<span data-nosnippet>506</span>
<span data-nosnippet>507</span>    <span class="kw">fn </span>augment_matching(<span class="kw-2">&amp;mut </span><span class="self">self</span>, k: usize) {
<span data-nosnippet>508</span>        <span class="kw">let </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>509</span>        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>510</span>        <span class="kw">for </span>(s, p) <span class="kw">in </span>[(v, <span class="number">2 </span>* k + <span class="number">1</span>), (<a href="#525">w</a>, <span class="number">2 </span>* k)] {
<span data-nosnippet>511</span>            <span class="kw">let </span><span class="kw-2">mut </span>s = s;
<span data-nosnippet>512</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = p;
<span data-nosnippet>513</span>            <span class="kw">loop </span>{
<span data-nosnippet>514</span>                <span class="kw">let </span>bs = <span class="self">self</span>.inblossom[s];
<span data-nosnippet>515</span>                <span class="kw">if </span>bs &gt;= <span class="self">self</span>.n {
<span data-nosnippet>516</span>                    <span class="self">self</span>.augment_blossom(bs, s);
<span data-nosnippet>517</span>                }
<span data-nosnippet>518</span>                <span class="self">self</span>.mate[s] = p;
<span data-nosnippet>519</span>                <span class="kw">if </span><span class="self">self</span>.labelend[bs] == !<span class="number">0 </span>{
<span data-nosnippet>520</span>                    <span class="kw">break</span>;
<span data-nosnippet>521</span>                }
<span data-nosnippet>522</span>                <span class="kw">let </span>t = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bs]];
<span data-nosnippet>523</span>                <span class="kw">let </span>bt = <span class="self">self</span>.inblossom[<a href="#543">t</a>];
<span data-nosnippet>524</span>                <span class="kw">let </span>s2 = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt]];
<span data-nosnippet>525</span>                <span class="kw">let </span>j = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>];
<span data-nosnippet>526</span>                <span class="kw">if </span>bt &gt;= <span class="self">self</span>.n {
<span data-nosnippet>527</span>                    <span class="self">self</span>.augment_blossom(bt, j);
<span data-nosnippet>528</span>                }
<span data-nosnippet>529</span>                <span class="self">self</span>.mate[j] = <span class="self">self</span>.labelend[bt];
<span data-nosnippet>530</span>                p = <span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>;
<span data-nosnippet>531</span>                s = s2;
<span data-nosnippet>532</span>            }
<span data-nosnippet>533</span>        }
<span data-nosnippet>534</span>    }
<span data-nosnippet>535</span>
<span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.assign_label(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.<span class="highlight">slack</span>(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.assign_label(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.scan_blossom(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.add_blossom(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.augment_matching(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.<span class="highlight">slack</span>(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.<span class="highlight">slack</span>(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.<span class="highlight">slack</span>(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.<span class="highlight">slack</span>(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.expand_blossom(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.expand_blossom(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.blossom_leaves" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#177-189">Source</a><h4 class="code-header">fn <a href="#method.blossom_leaves" class="fn">blossom_leaves</a>(&amp;self, b: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, out: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-2"><a href="#scraped-examples-2">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[8,8],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#185&#34;,&#34;line 185&#34;],[[24,24],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#201&#34;,&#34;line 201&#34;],[[107,107],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#284&#34;,&#34;line 284&#34;],[[119,119],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#296&#34;,&#34;line 296&#34;],[[190,190],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#367&#34;,&#34;line 367&#34;],[[255,255],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#432&#34;,&#34;line 432&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#185">line 185</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>177</span>    <span class="kw">fn </span>blossom_leaves(<span class="kw-2">&amp;</span><span class="self">self</span>, b: usize, out: <span class="kw-2">&amp;mut </span>Vec&lt;usize&gt;) {
<span data-nosnippet>178</span>        <span class="kw">if </span>b &lt; <span class="self">self</span>.n {
<span data-nosnippet>179</span>            out.push(b);
<span data-nosnippet>180</span>        } <span class="kw">else </span>{
<span data-nosnippet>181</span>            <span class="kw">for </span><span class="kw-2">&amp;</span>t <span class="kw">in </span><span class="kw-2">&amp;</span><span class="self">self</span>.blossomchilds[b] {
<span data-nosnippet>182</span>                <span class="kw">if </span>t &lt; <span class="self">self</span>.n {
<span data-nosnippet>183</span>                    out.push(t);
<span data-nosnippet>184</span>                } <span class="kw">else </span>{
<span data-nosnippet>185</span>                    <span class="self">self</span>.<span class="highlight focus">blossom_leaves</span>(t, out);
<span data-nosnippet>186</span>                }
<span data-nosnippet>187</span>            }
<span data-nosnippet>188</span>        }
<span data-nosnippet>189</span>    }
<span data-nosnippet>190</span>
<span data-nosnippet>191</span>    <span class="kw">fn </span>assign_label(<span class="kw-2">&amp;mut </span><span class="self">self</span>, w: usize, t: i32, p: usize) {
<span data-nosnippet>192</span>        <span class="kw">let </span>b = <span class="self">self</span>.inblossom[w];
<span data-nosnippet>193</span>        <span class="self">self</span>.label[w] = t;
<span data-nosnippet>194</span>        <span class="self">self</span>.label[b] = t;
<span data-nosnippet>195</span>        <span class="self">self</span>.labelend[w] = p;
<span data-nosnippet>196</span>        <span class="self">self</span>.labelend[b] = p;
<span data-nosnippet>197</span>        <span class="self">self</span>.bestedge[w] = !<span class="number">0</span>;
<span data-nosnippet>198</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>199</span>        <span class="kw">if </span>t == <span class="number">1 </span>{
<span data-nosnippet>200</span>            <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>201</span>            <span class="self">self</span>.<span class="highlight">blossom_leaves</span>(b, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>202</span>            <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>203</span>                <span class="self">self</span>.queue.push(v);
<span data-nosnippet>204</span>            }
<span data-nosnippet>205</span>        } <span class="kw">else </span>{
<span data-nosnippet>206</span>            <span class="kw">let </span>base = <span class="self">self</span>.blossombase[b];
<span data-nosnippet>207</span>            <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>208</span>            <span class="kw">if </span>m == !<span class="number">0 </span>{
<span data-nosnippet>209</span>                <span class="kw">return</span>;
<span data-nosnippet>210</span>            }
<span data-nosnippet>211</span>            <span class="kw">let </span>u = <span class="self">self</span>.endpoint[m];
<span data-nosnippet>212</span>            <span class="self">self</span>.assign_label(u, <span class="number">1</span>, m ^ <span class="number">1</span>);
<span data-nosnippet>213</span>        }
<span data-nosnippet>214</span>    }
<span data-nosnippet>215</span>
<span data-nosnippet>216</span>    <span class="kw">fn </span>scan_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, <span class="kw-2">mut </span>v: usize, <span class="kw-2">mut </span>w: usize) -&gt; usize {
<span data-nosnippet>217</span>        <span class="kw">let </span><span class="kw-2">mut </span>path: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>218</span>        <span class="kw">let </span><span class="kw-2">mut </span>base = !<span class="number">0</span>;
<span data-nosnippet>219</span>        <span class="kw">while </span><a href="#105">v !</a>= !<span class="number">0 </span>|| <span class="macro">w !</span>= !<span class="number">0 </span>{
<span data-nosnippet>220</span>            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>221</span>            <span class="kw">if </span>(<span class="self">self</span>.label[b] &amp; <span class="number">4</span>) != <span class="number">0 </span>{
<span data-nosnippet>222</span>                base = <span class="self">self</span>.blossombase[b];
<span data-nosnippet>223</span>                <span class="kw">break</span>;
<span data-nosnippet>224</span>            }
<span data-nosnippet>225</span>            path.push(b);
<span data-nosnippet>226</span>            <span class="self">self</span>.label[b] = <span class="number">5</span>;
<span data-nosnippet>227</span>            <span class="kw">if </span><span class="self">self</span>.labelend[b] == !<span class="number">0 </span>{
<span data-nosnippet>228</span>                v = !<span class="number">0</span>;
<span data-nosnippet>229</span>            } <span class="kw">else </span>{
<span data-nosnippet>230</span>                v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[b]];
<span data-nosnippet>231</span>                <span class="kw">let </span>b2 = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>232</span>                v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[b2]];
<span data-nosnippet>233</span>            }
<span data-nosnippet>234</span>            <span class="kw">if </span><span class="macro">w !</span>= !<span class="number">0 </span>{
<span data-nosnippet>235</span>                std::mem::swap(<span class="kw-2">&amp;mut </span>v, <span class="kw-2">&amp;mut </span>w);
<span data-nosnippet>236</span>            }
<span data-nosnippet>237</span>        }
<span data-nosnippet>238</span>        <span class="kw">for </span>b <span class="kw">in </span>path {
<span data-nosnippet>239</span>            <span class="self">self</span>.label[b] = <span class="number">1</span>;
<span data-nosnippet>240</span>        }
<span data-nosnippet>241</span>        base
<span data-nosnippet>242</span>    }
<span data-nosnippet>243</span>
<span data-nosnippet>244</span>    <span class="kw">fn </span>add_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, base: usize, k: usize) {
<span data-nosnippet>245</span>        <span class="kw">let </span><span class="kw-2">mut </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>246</span>        <span class="kw">let </span><span class="kw-2">mut </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>247</span>        <span class="kw">let </span>bb = <span class="self">self</span>.inblossom[base];
<span data-nosnippet>248</span>        <span class="kw">let </span><span class="kw-2">mut </span>bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>249</span>        <span class="kw">let </span><span class="kw-2">mut </span>bw = <span class="self">self</span>.<a href="https://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html">inblossom</a>[w];
<span data-nosnippet>250</span>        <span class="kw">let </span>b = <span class="self">self</span>.unusedblossoms.pop().unwrap();
<span data-nosnippet>251</span>        <span class="self">self</span>.blossombase[b] = base;
<span data-nosnippet>252</span>        <span class="self">self</span>.blossomparent[b] = !<span class="number">0</span>;
<span data-nosnippet>253</span>        <span class="self">self</span>.blossomparent[bb] = b;
<span data-nosnippet>254</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>255</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>256</span>        <span class="kw">let </span><span class="kw-2">mut </span>path: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>257</span>        <span class="kw">let </span><span class="kw-2">mut </span>endps: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>258</span>        <span class="kw">while </span><span class="macro">bv !</span>= bb {
<span data-nosnippet>259</span>            <span class="self">self</span>.blossomparent[bv] = b;
<span data-nosnippet>260</span>            path.push(bv);
<span data-nosnippet>261</span>            endps.push(<span class="self">self</span>.labelend[bv]);
<span data-nosnippet>262</span>            v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bv]];
<span data-nosnippet>263</span>            bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>264</span>        }
<span data-nosnippet>265</span>        path.push(bb);
<span data-nosnippet>266</span>        path.reverse();
<span data-nosnippet>267</span>        <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>268</span>        endps.reverse();
<span data-nosnippet>269</span>        endps.push(<span class="number">2 </span>* k);
<span data-nosnippet>270</span>        <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>271</span>        <span class="kw">while </span><span class="macro">bw !</span>= bb {
<span data-nosnippet>272</span>            <span class="self">self</span>.blossomparent[bw] = b;
<span data-nosnippet>273</span>            path.push(bw);
<span data-nosnippet>274</span>            <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>275</span>            endps.push(<span class="self">self</span>.labelend[bw] ^ <span class="number">1</span>);
<span data-nosnippet>276</span>            <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>277</span>            w = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bw]];
<span data-nosnippet>278</span>            bw = <span class="self">self</span>.inblossom[w];
<span data-nosnippet>279</span>        }
<span data-nosnippet>280</span>        <span class="self">self</span>.label[b] = <span class="number">1</span>;
<span data-nosnippet>281</span>        <span class="self">self</span>.labelend[b] = <span class="self">self</span>.labelend[bb];
<span data-nosnippet>282</span>        <span class="self">self</span>.dualvar[b] = <span class="number">0</span>;
<span data-nosnippet>283</span>        <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>284</span>        <span class="self">self</span>.<span class="highlight">blossom_leaves</span>(b, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>285</span>        <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>286</span>            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>287</span>                <span class="self">self</span>.queue.push(v);
<span data-nosnippet>288</span>            }
<span data-nosnippet>289</span>            <span class="self">self</span>.inblossom[v] = b;
<span data-nosnippet>290</span>        }
<span data-nosnippet>291</span>        <span class="kw">let </span><span class="kw-2">mut </span>bestedgeto = <span class="macro">vec!</span>[!<span class="number">0</span>; <span class="number">2 </span>* <span class="self">self</span>.n];
<span data-nosnippet>292</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>bv <span class="kw">in </span><span class="kw-2">&amp;</span>path {
<span data-nosnippet>293</span>            <span class="kw">let </span>nblists: Vec&lt;Vec&lt;usize&gt;&gt; = <span class="kw">if </span><span class="self">self</span>.blossombestedges[bv].is_empty() {
<span data-nosnippet>294</span>                <span class="kw">let </span><span class="kw-2">mut </span>lists = Vec::new();
<span data-nosnippet>295</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>296</span>                <span class="self">self</span>.<span class="highlight">blossom_leaves</span>(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>297</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>298</span>                    <span class="kw">let </span><span class="kw-2">mut </span>list = Vec::new();
<span data-nosnippet>299</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>300</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>301</span>                        list.push(p / <span class="number">2</span>);
<span data-nosnippet>302</span>                    }
<span data-nosnippet>303</span>                    lists.push(list);
<span data-nosnippet>304</span>                }
<span data-nosnippet>305</span>                lists
<span data-nosnippet>306</span>            } <span class="kw">else </span>{
<span data-nosnippet>307</span>                <span class="macro">vec!</span>[<span class="self">self</span>.blossombestedges[bv].clone()]
<span data-nosnippet>308</span>            };
<span data-nosnippet>309</span>            <span class="kw">for </span>nblist <span class="kw">in </span>nblists {
<span data-nosnippet>310</span>                <span class="kw">for </span>k <span class="kw">in </span>nblist {
<span data-nosnippet>311</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>312</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>313</span>                    <span class="kw">if </span><span class="self">self</span>.inblossom[j] == b {
<span data-nosnippet>314</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>315</span>                    }
<span data-nosnippet>316</span>                    <span class="kw">let </span>bj = <span class="self">self</span>.inblossom[j];
<span data-nosnippet>317</span>                    <span class="kw">if </span><span class="macro">bj !</span>= b
<span data-nosnippet>318</span>                        &amp;&amp; <span class="self">self</span>.label[bj] == <span class="number">1
<span data-nosnippet>319</span>                        </span>&amp;&amp; (bestedgeto[bj] == !<span class="number">0 </span>|| <span class="self">self</span>.slack(k) &lt; <span class="self">self</span>.slack(bestedgeto[bj]))
<span data-nosnippet>320</span>                    {
<span data-nosnippet>321</span>                        bestedgeto[bj] = k;
<span data-nosnippet>322</span>                    }
<span data-nosnippet>323</span>                }
<span data-nosnippet>324</span>            }
<span data-nosnippet>325</span>            <span class="self">self</span>.blossombestedges[bv].clear();
<span data-nosnippet>326</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>327</span>        }
<span data-nosnippet>328</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>329</span>        <span class="kw">for </span>k <span class="kw">in </span>bestedgeto {
<span data-nosnippet>330</span>            <span class="kw">if </span><span class="macro">k !</span>= !<span class="number">0 </span>{
<span data-nosnippet>331</span>                <span class="self">self</span>.blossombestedges[b].push(k);
<span data-nosnippet>332</span>            }
<span data-nosnippet>333</span>        }
<span data-nosnippet>334</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>335</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>k <span class="kw">in </span><span class="kw-2">&amp;</span><span class="self">self</span>.blossombestedges[b] {
<span data-nosnippet>336</span>            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| <span class="self">self</span>.slack(k) &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>337</span>                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>338</span>            }
<span data-nosnippet>339</span>        }
<span data-nosnippet>340</span>    }
<span data-nosnippet>341</span>
<span data-nosnippet>342</span>    <span class="kw">fn </span>step_index(len: usize, j: usize, forward: bool) -&gt; usize {
<span data-nosnippet>343</span>        <span class="kw">if </span>forward {
<span data-nosnippet>344</span>            <span class="kw">let </span>next = j + <span class="number">1</span>;
<span data-nosnippet>345</span>            <span class="kw">if </span>next == len { <span class="number">0 </span>} <span class="kw">else </span>{ next }
<span data-nosnippet>346</span>        } <span class="kw">else if </span>j == <span class="number">0 </span>{
<span data-nosnippet>347</span>            len - <span class="number">1
<span data-nosnippet>348</span>        </span>} <span class="kw">else </span>{
<span data-nosnippet>349</span>            j - <span class="number">1
<span data-nosnippet>350</span>        </span>}
<span data-nosnippet>351</span>    }
<span data-nosnippet>352</span>
<span data-nosnippet>353</span>    <span class="kw">fn </span>dec_index(len: usize, j: usize) -&gt; usize {
<span data-nosnippet>354</span>        <span class="kw">if </span>j == <span class="number">0 </span>{ len - <span class="number">1 </span>} <span class="kw">else </span>{ j - <span class="number">1 </span>}
<span data-nosnippet>355</span>    }
<span data-nosnippet>356</span>
<span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.expand_blossom(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.<span class="highlight">blossom_leaves</span>(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.assign_label(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.<span class="highlight">blossom_leaves</span>(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.assign_label(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.assign_label" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#191-214">Source</a><h4 class="code-header">fn <a href="#method.assign_label" class="fn">assign_label</a>(&amp;mut self, w: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, t: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a>, p: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-3"><a href="#scraped-examples-3">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[21,21],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#212&#34;,&#34;line 212&#34;],[[207,207],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#398&#34;,&#34;line 398&#34;],[[253,253],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#444&#34;,&#34;line 444&#34;],[[356,356],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#547&#34;,&#34;line 547&#34;],[[381,381],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#572&#34;,&#34;line 572&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#212">line 212</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>191</span>    <span class="kw">fn </span>assign_label(<span class="kw-2">&amp;mut </span><span class="self">self</span>, w: usize, t: i32, p: usize) {
<span data-nosnippet>192</span>        <span class="kw">let </span>b = <span class="self">self</span>.inblossom[w];
<span data-nosnippet>193</span>        <span class="self">self</span>.label[w] = t;
<span data-nosnippet>194</span>        <span class="self">self</span>.label[b] = t;
<span data-nosnippet>195</span>        <span class="self">self</span>.labelend[w] = p;
<span data-nosnippet>196</span>        <span class="self">self</span>.labelend[b] = p;
<span data-nosnippet>197</span>        <span class="self">self</span>.bestedge[w] = !<span class="number">0</span>;
<span data-nosnippet>198</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>199</span>        <span class="kw">if </span>t == <span class="number">1 </span>{
<span data-nosnippet>200</span>            <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>201</span>            <span class="self">self</span>.blossom_leaves(b, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>202</span>            <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>203</span>                <span class="self">self</span>.queue.push(v);
<span data-nosnippet>204</span>            }
<span data-nosnippet>205</span>        } <span class="kw">else </span>{
<span data-nosnippet>206</span>            <span class="kw">let </span>base = <span class="self">self</span>.blossombase[b];
<span data-nosnippet>207</span>            <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>208</span>            <span class="kw">if </span>m == !<span class="number">0 </span>{
<span data-nosnippet>209</span>                <span class="kw">return</span>;
<span data-nosnippet>210</span>            }
<span data-nosnippet>211</span>            <span class="kw">let </span>u = <span class="self">self</span>.endpoint[m];
<span data-nosnippet>212</span>            <span class="self">self</span>.<span class="highlight focus">assign_label</span>(u, <span class="number">1</span>, m ^ <span class="number">1</span>);
<span data-nosnippet>213</span>        }
<span data-nosnippet>214</span>    }
<span data-nosnippet>215</span>
<span data-nosnippet>216</span>    <span class="kw">fn </span>scan_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, <span class="kw-2">mut </span>v: usize, <span class="kw-2">mut </span>w: usize) -&gt; usize {
<span data-nosnippet>217</span>        <span class="kw">let </span><span class="kw-2">mut </span>path: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>218</span>        <span class="kw">let </span><span class="kw-2">mut </span>base = !<span class="number">0</span>;
<span data-nosnippet>219</span>        <span class="kw">while </span><a href="#105">v !</a>= !<span class="number">0 </span>|| <span class="macro">w !</span>= !<span class="number">0 </span>{
<span data-nosnippet>220</span>            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>221</span>            <span class="kw">if </span>(<span class="self">self</span>.label[b] &amp; <span class="number">4</span>) != <span class="number">0 </span>{
<span data-nosnippet>222</span>                base = <span class="self">self</span>.blossombase[b];
<span data-nosnippet>223</span>                <span class="kw">break</span>;
<span data-nosnippet>224</span>            }
<span data-nosnippet>225</span>            path.push(b);
<span data-nosnippet>226</span>            <span class="self">self</span>.label[b] = <span class="number">5</span>;
<span data-nosnippet>227</span>            <span class="kw">if </span><span class="self">self</span>.labelend[b] == !<span class="number">0 </span>{
<span data-nosnippet>228</span>                v = !<span class="number">0</span>;
<span data-nosnippet>229</span>            } <span class="kw">else </span>{
<span data-nosnippet>230</span>                v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[b]];
<span data-nosnippet>231</span>                <span class="kw">let </span>b2 = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>232</span>                v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[b2]];
<span data-nosnippet>233</span>            }
<span data-nosnippet>234</span>            <span class="kw">if </span><span class="macro">w !</span>= !<span class="number">0 </span>{
<span data-nosnippet>235</span>                std::mem::swap(<span class="kw-2">&amp;mut </span>v, <span class="kw-2">&amp;mut </span>w);
<span data-nosnippet>236</span>            }
<span data-nosnippet>237</span>        }
<span data-nosnippet>238</span>        <span class="kw">for </span>b <span class="kw">in </span>path {
<span data-nosnippet>239</span>            <span class="self">self</span>.label[b] = <span class="number">1</span>;
<span data-nosnippet>240</span>        }
<span data-nosnippet>241</span>        base
<span data-nosnippet>242</span>    }
<span data-nosnippet>243</span>
<span data-nosnippet>244</span>    <span class="kw">fn </span>add_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, base: usize, k: usize) {
<span data-nosnippet>245</span>        <span class="kw">let </span><span class="kw-2">mut </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>246</span>        <span class="kw">let </span><span class="kw-2">mut </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>247</span>        <span class="kw">let </span>bb = <span class="self">self</span>.inblossom[base];
<span data-nosnippet>248</span>        <span class="kw">let </span><span class="kw-2">mut </span>bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>249</span>        <span class="kw">let </span><span class="kw-2">mut </span>bw = <span class="self">self</span>.<a href="https://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html">inblossom</a>[w];
<span data-nosnippet>250</span>        <span class="kw">let </span>b = <span class="self">self</span>.unusedblossoms.pop().unwrap();
<span data-nosnippet>251</span>        <span class="self">self</span>.blossombase[b] = base;
<span data-nosnippet>252</span>        <span class="self">self</span>.blossomparent[b] = !<span class="number">0</span>;
<span data-nosnippet>253</span>        <span class="self">self</span>.blossomparent[bb] = b;
<span data-nosnippet>254</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>255</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>256</span>        <span class="kw">let </span><span class="kw-2">mut </span>path: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>257</span>        <span class="kw">let </span><span class="kw-2">mut </span>endps: Vec&lt;usize&gt; = Vec::new();
<span data-nosnippet>258</span>        <span class="kw">while </span><span class="macro">bv !</span>= bb {
<span data-nosnippet>259</span>            <span class="self">self</span>.blossomparent[bv] = b;
<span data-nosnippet>260</span>            path.push(bv);
<span data-nosnippet>261</span>            endps.push(<span class="self">self</span>.labelend[bv]);
<span data-nosnippet>262</span>            v = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bv]];
<span data-nosnippet>263</span>            bv = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>264</span>        }
<span data-nosnippet>265</span>        path.push(bb);
<span data-nosnippet>266</span>        path.reverse();
<span data-nosnippet>267</span>        <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>268</span>        endps.reverse();
<span data-nosnippet>269</span>        endps.push(<span class="number">2 </span>* k);
<span data-nosnippet>270</span>        <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>271</span>        <span class="kw">while </span><span class="macro">bw !</span>= bb {
<span data-nosnippet>272</span>            <span class="self">self</span>.blossomparent[bw] = b;
<span data-nosnippet>273</span>            path.push(bw);
<span data-nosnippet>274</span>            <span class="self">self</span>.blossomchilds[b] = path.clone();
<span data-nosnippet>275</span>            endps.push(<span class="self">self</span>.labelend[bw] ^ <span class="number">1</span>);
<span data-nosnippet>276</span>            <span class="self">self</span>.blossomendps[b] = endps.clone();
<span data-nosnippet>277</span>            w = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bw]];
<span data-nosnippet>278</span>            bw = <span class="self">self</span>.inblossom[w];
<span data-nosnippet>279</span>        }
<span data-nosnippet>280</span>        <span class="self">self</span>.label[b] = <span class="number">1</span>;
<span data-nosnippet>281</span>        <span class="self">self</span>.labelend[b] = <span class="self">self</span>.labelend[bb];
<span data-nosnippet>282</span>        <span class="self">self</span>.dualvar[b] = <span class="number">0</span>;
<span data-nosnippet>283</span>        <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>284</span>        <span class="self">self</span>.blossom_leaves(b, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>285</span>        <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>286</span>            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>287</span>                <span class="self">self</span>.queue.push(v);
<span data-nosnippet>288</span>            }
<span data-nosnippet>289</span>            <span class="self">self</span>.inblossom[v] = b;
<span data-nosnippet>290</span>        }
<span data-nosnippet>291</span>        <span class="kw">let </span><span class="kw-2">mut </span>bestedgeto = <span class="macro">vec!</span>[!<span class="number">0</span>; <span class="number">2 </span>* <span class="self">self</span>.n];
<span data-nosnippet>292</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>bv <span class="kw">in </span><span class="kw-2">&amp;</span>path {
<span data-nosnippet>293</span>            <span class="kw">let </span>nblists: Vec&lt;Vec&lt;usize&gt;&gt; = <span class="kw">if </span><span class="self">self</span>.blossombestedges[bv].is_empty() {
<span data-nosnippet>294</span>                <span class="kw">let </span><span class="kw-2">mut </span>lists = Vec::new();
<span data-nosnippet>295</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>296</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>297</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>298</span>                    <span class="kw">let </span><span class="kw-2">mut </span>list = Vec::new();
<span data-nosnippet>299</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>300</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>301</span>                        list.push(p / <span class="number">2</span>);
<span data-nosnippet>302</span>                    }
<span data-nosnippet>303</span>                    lists.push(list);
<span data-nosnippet>304</span>                }
<span data-nosnippet>305</span>                lists
<span data-nosnippet>306</span>            } <span class="kw">else </span>{
<span data-nosnippet>307</span>                <span class="macro">vec!</span>[<span class="self">self</span>.blossombestedges[bv].clone()]
<span data-nosnippet>308</span>            };
<span data-nosnippet>309</span>            <span class="kw">for </span>nblist <span class="kw">in </span>nblists {
<span data-nosnippet>310</span>                <span class="kw">for </span>k <span class="kw">in </span>nblist {
<span data-nosnippet>311</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>312</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>313</span>                    <span class="kw">if </span><span class="self">self</span>.inblossom[j] == b {
<span data-nosnippet>314</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>315</span>                    }
<span data-nosnippet>316</span>                    <span class="kw">let </span>bj = <span class="self">self</span>.inblossom[j];
<span data-nosnippet>317</span>                    <span class="kw">if </span><span class="macro">bj !</span>= b
<span data-nosnippet>318</span>                        &amp;&amp; <span class="self">self</span>.label[bj] == <span class="number">1
<span data-nosnippet>319</span>                        </span>&amp;&amp; (bestedgeto[bj] == !<span class="number">0 </span>|| <span class="self">self</span>.slack(k) &lt; <span class="self">self</span>.slack(bestedgeto[bj]))
<span data-nosnippet>320</span>                    {
<span data-nosnippet>321</span>                        bestedgeto[bj] = k;
<span data-nosnippet>322</span>                    }
<span data-nosnippet>323</span>                }
<span data-nosnippet>324</span>            }
<span data-nosnippet>325</span>            <span class="self">self</span>.blossombestedges[bv].clear();
<span data-nosnippet>326</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>327</span>        }
<span data-nosnippet>328</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>329</span>        <span class="kw">for </span>k <span class="kw">in </span>bestedgeto {
<span data-nosnippet>330</span>            <span class="kw">if </span><span class="macro">k !</span>= !<span class="number">0 </span>{
<span data-nosnippet>331</span>                <span class="self">self</span>.blossombestedges[b].push(k);
<span data-nosnippet>332</span>            }
<span data-nosnippet>333</span>        }
<span data-nosnippet>334</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>335</span>        <span class="kw">for </span><span class="kw-2">&amp;</span>k <span class="kw">in </span><span class="kw-2">&amp;</span><span class="self">self</span>.blossombestedges[b] {
<span data-nosnippet>336</span>            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| <span class="self">self</span>.slack(k) &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>337</span>                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>338</span>            }
<span data-nosnippet>339</span>        }
<span data-nosnippet>340</span>    }
<span data-nosnippet>341</span>
<span data-nosnippet>342</span>    <span class="kw">fn </span>step_index(len: usize, j: usize, forward: bool) -&gt; usize {
<span data-nosnippet>343</span>        <span class="kw">if </span>forward {
<span data-nosnippet>344</span>            <span class="kw">let </span>next = j + <span class="number">1</span>;
<span data-nosnippet>345</span>            <span class="kw">if </span>next == len { <span class="number">0 </span>} <span class="kw">else </span>{ next }
<span data-nosnippet>346</span>        } <span class="kw">else if </span>j == <span class="number">0 </span>{
<span data-nosnippet>347</span>            len - <span class="number">1
<span data-nosnippet>348</span>        </span>} <span class="kw">else </span>{
<span data-nosnippet>349</span>            j - <span class="number">1
<span data-nosnippet>350</span>        </span>}
<span data-nosnippet>351</span>    }
<span data-nosnippet>352</span>
<span data-nosnippet>353</span>    <span class="kw">fn </span>dec_index(len: usize, j: usize) -&gt; usize {
<span data-nosnippet>354</span>        <span class="kw">if </span>j == <span class="number">0 </span>{ len - <span class="number">1 </span>} <span class="kw">else </span>{ j - <span class="number">1 </span>}
<span data-nosnippet>355</span>    }
<span data-nosnippet>356</span>
<span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.expand_blossom(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.blossom_leaves(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.<span class="highlight">assign_label</span>(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.<span class="highlight">assign_label</span>(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }
<span data-nosnippet>458</span>
<span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.augment_blossom(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.augment_blossom(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.augment_blossom(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }
<span data-nosnippet>506</span>
<span data-nosnippet>507</span>    <span class="kw">fn </span>augment_matching(<span class="kw-2">&amp;mut </span><span class="self">self</span>, k: usize) {
<span data-nosnippet>508</span>        <span class="kw">let </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>509</span>        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>510</span>        <span class="kw">for </span>(s, p) <span class="kw">in </span>[(v, <span class="number">2 </span>* k + <span class="number">1</span>), (<a href="#525">w</a>, <span class="number">2 </span>* k)] {
<span data-nosnippet>511</span>            <span class="kw">let </span><span class="kw-2">mut </span>s = s;
<span data-nosnippet>512</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = p;
<span data-nosnippet>513</span>            <span class="kw">loop </span>{
<span data-nosnippet>514</span>                <span class="kw">let </span>bs = <span class="self">self</span>.inblossom[s];
<span data-nosnippet>515</span>                <span class="kw">if </span>bs &gt;= <span class="self">self</span>.n {
<span data-nosnippet>516</span>                    <span class="self">self</span>.augment_blossom(bs, s);
<span data-nosnippet>517</span>                }
<span data-nosnippet>518</span>                <span class="self">self</span>.mate[s] = p;
<span data-nosnippet>519</span>                <span class="kw">if </span><span class="self">self</span>.labelend[bs] == !<span class="number">0 </span>{
<span data-nosnippet>520</span>                    <span class="kw">break</span>;
<span data-nosnippet>521</span>                }
<span data-nosnippet>522</span>                <span class="kw">let </span>t = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bs]];
<span data-nosnippet>523</span>                <span class="kw">let </span>bt = <span class="self">self</span>.inblossom[<a href="#543">t</a>];
<span data-nosnippet>524</span>                <span class="kw">let </span>s2 = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt]];
<span data-nosnippet>525</span>                <span class="kw">let </span>j = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>];
<span data-nosnippet>526</span>                <span class="kw">if </span>bt &gt;= <span class="self">self</span>.n {
<span data-nosnippet>527</span>                    <span class="self">self</span>.augment_blossom(bt, j);
<span data-nosnippet>528</span>                }
<span data-nosnippet>529</span>                <span class="self">self</span>.mate[j] = <span class="self">self</span>.labelend[bt];
<span data-nosnippet>530</span>                p = <span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>;
<span data-nosnippet>531</span>                s = s2;
<span data-nosnippet>532</span>            }
<span data-nosnippet>533</span>        }
<span data-nosnippet>534</span>    }
<span data-nosnippet>535</span>
<span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.<span class="highlight">assign_label</span>(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.slack(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.<span class="highlight">assign_label</span>(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.scan_blossom(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.add_blossom(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.augment_matching(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.expand_blossom(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.expand_blossom(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.scan_blossom" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#216-242">Source</a><h4 class="code-header">fn <a href="#method.scan_blossom" class="fn">scan_blossom</a>(&amp;mut self, v: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, w: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-4"><a href="#scraped-examples-4">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[38,38],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#574&#34;,&#34;line 574&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#574">line 574</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.assign_label(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.slack(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.assign_label(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.<span class="highlight focus">scan_blossom</span>(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.add_blossom(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.augment_matching(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.expand_blossom(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.expand_blossom(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.add_blossom" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#244-340">Source</a><h4 class="code-header">fn <a href="#method.add_blossom" class="fn">add_blossom</a>(&amp;mut self, base: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, k: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-5"><a href="#scraped-examples-5">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[40,40],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#576&#34;,&#34;line 576&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#576">line 576</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.assign_label(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.slack(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.assign_label(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.scan_blossom(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.<span class="highlight focus">add_blossom</span>(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.augment_matching(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.expand_blossom(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.expand_blossom(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.step_index" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#342-351">Source</a><h4 class="code-header">fn <a href="#method.step_index" class="fn">step_index</a>(len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, j: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, forward: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-6"><a href="#scraped-examples-6">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[44,44],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#401&#34;,&#34;line 401&#34;],[[53,53],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#410&#34;,&#34;line 410&#34;],[[62,62],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#419&#34;,&#34;line 419&#34;],[[70,70],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#427&#34;,&#34;line 427&#34;],[[89,89],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#446&#34;,&#34;line 446&#34;],[[116,116],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#473&#34;,&#34;line 473&#34;],[[127,127],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#484&#34;,&#34;line 484&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#401">line 401</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.expand_blossom(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.blossom_leaves(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.assign_label(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="highlight focus"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.assign_label(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }
<span data-nosnippet>458</span>
<span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.augment_blossom(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.augment_blossom(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="highlight"><span class="self">Self</span>::step_index</span>(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.augment_blossom(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.dec_index" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#353-355">Source</a><h4 class="code-header">fn <a href="#method.dec_index" class="fn">dec_index</a>(len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, j: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-7"><a href="#scraped-examples-7">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[36,36],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#393&#34;,&#34;line 393&#34;],[[48,48],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#405&#34;,&#34;line 405&#34;],[[121,121],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#478&#34;,&#34;line 478&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#393">line 393</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.expand_blossom(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.blossom_leaves(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="highlight focus"><span class="self">Self</span>::dec_index</span>(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.assign_label(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="highlight"><span class="self">Self</span>::dec_index</span>(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.assign_label(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }
<span data-nosnippet>458</span>
<span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.augment_blossom(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="highlight"><span class="self">Self</span>::dec_index</span>(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.augment_blossom(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.augment_blossom(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.expand_blossom" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#357-457">Source</a><h4 class="code-header">fn <a href="#method.expand_blossom" class="fn">expand_blossom</a>(&amp;mut self, b: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, endstage: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-8"><a href="#scraped-examples-8">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[7,7],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#364&#34;,&#34;line 364&#34;],[[328,328],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#685&#34;,&#34;line 685&#34;],[[340,340],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#697&#34;,&#34;line 697&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#364">line 364</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>357</span>    <span class="kw">fn </span>expand_blossom(<span class="kw-2">&amp;mut </span><a class="self" href="../num/zero_one.rs.html#1-14">self</a>, b: usize, endstage: bool) {
<span data-nosnippet>358</span>        <span class="kw">let </span>childs = <span class="self">self</span>.blossomchilds[b].clone();
<span data-nosnippet>359</span>        <span class="kw">for </span>s <span class="kw">in </span>childs {
<span data-nosnippet>360</span>            <span class="self">self</span>.blossomparent[s] = !<span class="number">0</span>;
<span data-nosnippet>361</span>            <span class="kw">if </span>s &lt; <span class="self">self</span>.n {
<span data-nosnippet>362</span>                <span class="self">self</span>.inblossom[s] = s;
<span data-nosnippet>363</span>            } <span class="kw">else if </span>endstage &amp;&amp; <span class="self">self</span>.dualvar[s] == <span class="number">0 </span>{
<span data-nosnippet>364</span>                <span class="self">self</span>.<span class="highlight focus">expand_blossom</span>(s, endstage);
<span data-nosnippet>365</span>            } <span class="kw">else </span>{
<span data-nosnippet>366</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>367</span>                <span class="self">self</span>.blossom_leaves(s, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>368</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>369</span>                    <span class="self">self</span>.inblossom[v] = s;
<span data-nosnippet>370</span>                }
<span data-nosnippet>371</span>            }
<span data-nosnippet>372</span>        }
<span data-nosnippet>373</span>        <span class="kw">if </span>!endstage &amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>374</span>            <span class="kw">let </span>entrychild = {
<span data-nosnippet>375</span>                <span class="kw">let </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>376</span>                <span class="kw">let </span>u = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>377</span>                <span class="self">self</span>.inblossom[u]
<span data-nosnippet>378</span>            };
<span data-nosnippet>379</span>            <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>380</span>            <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.blossomchilds[<a href="#318">b</a>]
<span data-nosnippet>381</span>                .iter()
<span data-nosnippet>382</span>                .position(|<span class="kw-2">&amp;</span>x| x == entrychild)
<span data-nosnippet>383</span>                .unwrap();
<span data-nosnippet>384</span>            <span class="kw">let </span>forward = j % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>385</span>            <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>386</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = <span class="self">self</span>.labelend[b];
<span data-nosnippet>387</span>            <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>388</span>                <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>389</span>                <span class="self">self</span>.label[v1] = <span class="number">0</span>;
<span data-nosnippet>390</span>                <span class="kw">let </span>idx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>391</span>                    j
<span data-nosnippet>392</span>                } <span class="kw">else </span>{
<span data-nosnippet>393</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>394</span>                };
<span data-nosnippet>395</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>396</span>                <span class="kw">let </span>v2 = <span class="self">self</span>.endpoint[(tmp ^ endptrick) ^ <span class="number">1</span>];
<span data-nosnippet>397</span>                <span class="self">self</span>.label[v2] = <span class="number">0</span>;
<span data-nosnippet>398</span>                <span class="self">self</span>.assign_label(v1, <span class="number">2</span>, p);
<span data-nosnippet>399</span>                <span class="kw">let </span>tmp = <span class="self">self</span>.blossomendps[b][idx];
<span data-nosnippet>400</span>                <span class="self">self</span>.allowedge[tmp / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>401</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>402</span>                <span class="kw">let </span>idx2 = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>403</span>                    j
<span data-nosnippet>404</span>                } <span class="kw">else </span>{
<span data-nosnippet>405</span>                    <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>406</span>                };
<span data-nosnippet>407</span>                <span class="kw">let </span>tmp2 = <span class="self">self</span>.blossomendps[b][idx2];
<span data-nosnippet>408</span>                p = tmp2 ^ endptrick;
<span data-nosnippet>409</span>                <span class="self">self</span>.allowedge[p / <span class="number">2</span>] = <span class="bool-val">true</span>;
<span data-nosnippet>410</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>411</span>            }
<span data-nosnippet>412</span>            <span class="kw">let </span>bv = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>413</span>            <span class="kw">let </span>v1 = <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>];
<span data-nosnippet>414</span>            <span class="self">self</span>.label[v1] = <span class="number">2</span>;
<span data-nosnippet>415</span>            <span class="self">self</span>.label[bv] = <span class="number">2</span>;
<span data-nosnippet>416</span>            <span class="self">self</span>.labelend[v1] = p;
<span data-nosnippet>417</span>            <span class="self">self</span>.labelend[bv] = p;
<span data-nosnippet>418</span>            <span class="self">self</span>.bestedge[bv] = !<span class="number">0</span>;
<span data-nosnippet>419</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>420</span>            <span class="kw">loop </span>{
<span data-nosnippet>421</span>                <span class="kw">let </span>tmpb = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>422</span>                <span class="kw">if </span>tmpb == entrychild {
<span data-nosnippet>423</span>                    <span class="kw">break</span>;
<span data-nosnippet>424</span>                }
<span data-nosnippet>425</span>                <span class="kw">let </span>bv = tmpb;
<span data-nosnippet>426</span>                <span class="kw">if </span><span class="self">self</span>.label[bv] == <span class="number">1 </span>{
<span data-nosnippet>427</span>                    j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>428</span>                    <span class="kw">continue</span>;
<span data-nosnippet>429</span>                }
<span data-nosnippet>430</span>                <span class="kw">let </span><span class="kw-2">mut </span>reached: <span class="prelude-ty">Option</span>&lt;usize&gt; = <span class="prelude-val">None</span>;
<span data-nosnippet>431</span>                <span class="kw">let </span><span class="kw-2">mut </span>leaves = Vec::new();
<span data-nosnippet>432</span>                <span class="self">self</span>.blossom_leaves(bv, <span class="kw-2">&amp;mut </span>leaves);
<span data-nosnippet>433</span>                <span class="kw">for </span>v <span class="kw">in </span>leaves {
<span data-nosnippet>434</span>                    <span class="kw">if </span><span class="self">self</span>.label[v] != <span class="number">0 </span>{
<span data-nosnippet>435</span>                        reached = <span class="prelude-val">Some</span>(v);
<span data-nosnippet>436</span>                        <span class="kw">break</span>;
<span data-nosnippet>437</span>                    }
<span data-nosnippet>438</span>                }
<span data-nosnippet>439</span>                <span class="kw">if let </span><span class="prelude-val">Some</span>(v) = reached {
<span data-nosnippet>440</span>                    <span class="self">self</span>.label[v] = <span class="number">0</span>;
<span data-nosnippet>441</span>                    <span class="kw">let </span>base = <span class="self">self</span>.blossombase[bv];
<span data-nosnippet>442</span>                    <span class="kw">let </span>m = <span class="self">self</span>.mate[base];
<span data-nosnippet>443</span>                    <span class="self">self</span>.label[<span class="self">self</span>.endpoint[m]] = <span class="number">0</span>;
<span data-nosnippet>444</span>                    <span class="self">self</span>.assign_label(v, <span class="number">2</span>, <span class="self">self</span>.labelend[v]);
<span data-nosnippet>445</span>                }
<span data-nosnippet>446</span>                j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>447</span>            }
<span data-nosnippet>448</span>        }
<span data-nosnippet>449</span>        <span class="self">self</span>.label[b] = -<span class="number">1</span>;
<span data-nosnippet>450</span>        <span class="self">self</span>.labelend[b] = !<span class="number">0</span>;
<span data-nosnippet>451</span>        <span class="self">self</span>.blossomchilds[b].clear();
<span data-nosnippet>452</span>        <span class="self">self</span>.blossomendps[b].clear();
<span data-nosnippet>453</span>        <span class="self">self</span>.blossombase[b] = !<span class="number">0</span>;
<span data-nosnippet>454</span>        <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>455</span>        <span class="self">self</span>.bestedge[b] = !<span class="number">0</span>;
<span data-nosnippet>456</span>        <span class="self">self</span>.unusedblossoms.push(b);
<span data-nosnippet>457</span>    }
<span data-nosnippet>458</span>
<span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.augment_blossom(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.augment_blossom(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.augment_blossom(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }
<span data-nosnippet>506</span>
<span data-nosnippet>507</span>    <span class="kw">fn </span>augment_matching(<span class="kw-2">&amp;mut </span><span class="self">self</span>, k: usize) {
<span data-nosnippet>508</span>        <span class="kw">let </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>509</span>        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>510</span>        <span class="kw">for </span>(s, p) <span class="kw">in </span>[(v, <span class="number">2 </span>* k + <span class="number">1</span>), (<a href="#525">w</a>, <span class="number">2 </span>* k)] {
<span data-nosnippet>511</span>            <span class="kw">let </span><span class="kw-2">mut </span>s = s;
<span data-nosnippet>512</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = p;
<span data-nosnippet>513</span>            <span class="kw">loop </span>{
<span data-nosnippet>514</span>                <span class="kw">let </span>bs = <span class="self">self</span>.inblossom[s];
<span data-nosnippet>515</span>                <span class="kw">if </span>bs &gt;= <span class="self">self</span>.n {
<span data-nosnippet>516</span>                    <span class="self">self</span>.augment_blossom(bs, s);
<span data-nosnippet>517</span>                }
<span data-nosnippet>518</span>                <span class="self">self</span>.mate[s] = p;
<span data-nosnippet>519</span>                <span class="kw">if </span><span class="self">self</span>.labelend[bs] == !<span class="number">0 </span>{
<span data-nosnippet>520</span>                    <span class="kw">break</span>;
<span data-nosnippet>521</span>                }
<span data-nosnippet>522</span>                <span class="kw">let </span>t = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bs]];
<span data-nosnippet>523</span>                <span class="kw">let </span>bt = <span class="self">self</span>.inblossom[<a href="#543">t</a>];
<span data-nosnippet>524</span>                <span class="kw">let </span>s2 = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt]];
<span data-nosnippet>525</span>                <span class="kw">let </span>j = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>];
<span data-nosnippet>526</span>                <span class="kw">if </span>bt &gt;= <span class="self">self</span>.n {
<span data-nosnippet>527</span>                    <span class="self">self</span>.augment_blossom(bt, j);
<span data-nosnippet>528</span>                }
<span data-nosnippet>529</span>                <span class="self">self</span>.mate[j] = <span class="self">self</span>.labelend[bt];
<span data-nosnippet>530</span>                p = <span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>;
<span data-nosnippet>531</span>                s = s2;
<span data-nosnippet>532</span>            }
<span data-nosnippet>533</span>        }
<span data-nosnippet>534</span>    }
<span data-nosnippet>535</span>
<span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.assign_label(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.slack(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.assign_label(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.scan_blossom(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.add_blossom(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.augment_matching(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.<span class="highlight">expand_blossom</span>(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.<span class="highlight">expand_blossom</span>(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.augment_blossom" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#459-505">Source</a><h4 class="code-header">fn <a href="#method.augment_blossom" class="fn">augment_blossom</a>(&amp;mut self, b: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, v: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-9"><a href="#scraped-examples-9">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[6,6],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#465&#34;,&#34;line 465&#34;],[[23,23],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#482&#34;,&#34;line 482&#34;],[[28,28],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#487&#34;,&#34;line 487&#34;],[[57,57],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#516&#34;,&#34;line 516&#34;],[[68,68],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#527&#34;,&#34;line 527&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#465">line 465</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>459</span>    <span class="kw">fn </span>augment_blossom(<span class="kw-2">&amp;mut </span><span class="self">self</span>, b: usize, v: usize) {
<span data-nosnippet>460</span>        <span class="kw">let </span><span class="kw-2">mut </span>t = v;
<span data-nosnippet>461</span>        <span class="kw">while </span><span class="self">self</span>.blossomparent[t] != b {
<span data-nosnippet>462</span>            t = <span class="self">self</span>.blossomparent[t];
<span data-nosnippet>463</span>        }
<span data-nosnippet>464</span>        <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>465</span>            <span class="self">self</span>.<span class="highlight focus">augment_blossom</span>(t, v);
<span data-nosnippet>466</span>        }
<span data-nosnippet>467</span>        <span class="kw">let </span>len = <span class="self">self</span>.blossomchilds[b].len();
<span data-nosnippet>468</span>        <span class="kw">let </span>i = <span class="self">self</span>.blossomchilds[b].iter().position(|<span class="kw-2">&amp;</span>x| x == t).unwrap();
<span data-nosnippet>469</span>        <span class="kw">let </span><span class="kw-2">mut </span>j = i;
<span data-nosnippet>470</span>        <span class="kw">let </span>forward = i % <span class="number">2 </span>== <span class="number">1</span>;
<span data-nosnippet>471</span>        <span class="kw">let </span>endptrick = <span class="kw">if </span>forward { <span class="number">0usize </span>} <span class="kw">else </span>{ <span class="number">1usize </span>};
<span data-nosnippet>472</span>        <span class="kw">while </span><span class="macro">j !</span>= <span class="number">0 </span>{
<span data-nosnippet>473</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>474</span>            <span class="kw">let </span>t = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>475</span>            <span class="kw">let </span>pidx = <span class="kw">if </span>endptrick == <span class="number">0 </span>{
<span data-nosnippet>476</span>                j
<span data-nosnippet>477</span>            } <span class="kw">else </span>{
<span data-nosnippet>478</span>                <span class="self">Self</span>::dec_index(len, j)
<span data-nosnippet>479</span>            };
<span data-nosnippet>480</span>            <span class="kw">let </span>p = <span class="self">self</span>.blossomendps[b][pidx] ^ endptrick;
<span data-nosnippet>481</span>            <span class="kw">if </span>t &gt;= <span class="self">self</span>.n {
<span data-nosnippet>482</span>                <span class="self">self</span>.<span class="highlight">augment_blossom</span>(t, <span class="self">self</span>.endpoint[p]);
<span data-nosnippet>483</span>            }
<span data-nosnippet>484</span>            j = <span class="self">Self</span>::step_index(len, j, forward);
<span data-nosnippet>485</span>            <span class="kw">let </span>t2 = <span class="self">self</span>.blossomchilds[b][j];
<span data-nosnippet>486</span>            <span class="kw">if </span>t2 &gt;= <span class="self">self</span>.<a href="#499">n</a> {
<span data-nosnippet>487</span>                <span class="self">self</span>.<span class="highlight">augment_blossom</span>(t2, <span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]);
<span data-nosnippet>488</span>            }
<span data-nosnippet>489</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p]] = p ^ <span class="number">1</span>;
<span data-nosnippet>490</span>            <span class="self">self</span>.mate[<span class="self">self</span>.endpoint[p ^ <span class="number">1</span>]] = p;
<span data-nosnippet>491</span>        }
<span data-nosnippet>492</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_child = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>493</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomchilds[b].iter().enumerate() {
<span data-nosnippet>494</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>495</span>            new_child[pos] = val;
<span data-nosnippet>496</span>        }
<span data-nosnippet>497</span>        <span class="self">self</span>.blossomchilds[b] = new_child;
<span data-nosnippet>498</span>        <span class="kw">let </span><span class="kw-2">mut </span>new_endps = <span class="macro">vec!</span>[<span class="number">0usize</span>; len];
<span data-nosnippet>499</span>        <span class="kw">for </span>(idx, <span class="kw-2">&amp;</span>val) <span class="kw">in </span><span class="self">self</span>.blossomendps[b].iter().enumerate() {
<span data-nosnippet>500</span>            <span class="kw">let </span>pos = (idx + len - i) % len;
<span data-nosnippet>501</span>            new_endps[pos] = val;
<span data-nosnippet>502</span>        }
<span data-nosnippet>503</span>        <span class="self">self</span>.blossomendps[b] = new_endps;
<span data-nosnippet>504</span>        <span class="self">self</span>.blossombase[b] = <span class="self">self</span>.blossombase[<span class="self">self</span>.blossomchilds[b][<span class="number">0</span>]];
<span data-nosnippet>505</span>    }
<span data-nosnippet>506</span>
<span data-nosnippet>507</span>    <span class="kw">fn </span>augment_matching(<span class="kw-2">&amp;mut </span><span class="self">self</span>, k: usize) {
<span data-nosnippet>508</span>        <span class="kw">let </span>v = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>509</span>        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>510</span>        <span class="kw">for </span>(s, p) <span class="kw">in </span>[(v, <span class="number">2 </span>* k + <span class="number">1</span>), (<a href="#525">w</a>, <span class="number">2 </span>* k)] {
<span data-nosnippet>511</span>            <span class="kw">let </span><span class="kw-2">mut </span>s = s;
<span data-nosnippet>512</span>            <span class="kw">let </span><span class="kw-2">mut </span>p = p;
<span data-nosnippet>513</span>            <span class="kw">loop </span>{
<span data-nosnippet>514</span>                <span class="kw">let </span>bs = <span class="self">self</span>.inblossom[s];
<span data-nosnippet>515</span>                <span class="kw">if </span>bs &gt;= <span class="self">self</span>.n {
<span data-nosnippet>516</span>                    <span class="self">self</span>.<span class="highlight">augment_blossom</span>(bs, s);
<span data-nosnippet>517</span>                }
<span data-nosnippet>518</span>                <span class="self">self</span>.mate[s] = p;
<span data-nosnippet>519</span>                <span class="kw">if </span><span class="self">self</span>.labelend[bs] == !<span class="number">0 </span>{
<span data-nosnippet>520</span>                    <span class="kw">break</span>;
<span data-nosnippet>521</span>                }
<span data-nosnippet>522</span>                <span class="kw">let </span>t = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bs]];
<span data-nosnippet>523</span>                <span class="kw">let </span>bt = <span class="self">self</span>.inblossom[<a href="#543">t</a>];
<span data-nosnippet>524</span>                <span class="kw">let </span>s2 = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt]];
<span data-nosnippet>525</span>                <span class="kw">let </span>j = <span class="self">self</span>.endpoint[<span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>];
<span data-nosnippet>526</span>                <span class="kw">if </span>bt &gt;= <span class="self">self</span>.n {
<span data-nosnippet>527</span>                    <span class="self">self</span>.<span class="highlight">augment_blossom</span>(bt, j);
<span data-nosnippet>528</span>                }
<span data-nosnippet>529</span>                <span class="self">self</span>.mate[j] = <span class="self">self</span>.labelend[bt];
<span data-nosnippet>530</span>                p = <span class="self">self</span>.labelend[bt] ^ <span class="number">1</span>;
<span data-nosnippet>531</span>                s = s2;
<span data-nosnippet>532</span>            }
<span data-nosnippet>533</span>        }
<span data-nosnippet>534</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.augment_matching" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#507-534">Source</a><h4 class="code-header">fn <a href="#method.augment_matching" class="fn">augment_matching</a>(&amp;mut self, k: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-10"><a href="#scraped-examples-10">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[42,42],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#578&#34;,&#34;line 578&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#578">line 578</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>536</span>    <span class="kw">fn </span>solve(<span class="kw-2">&amp;mut </span><span class="self">self</span>, maxcardinality: bool) {
<span data-nosnippet>537</span>        <span class="kw">for _ in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>538</span>            <span class="self">self</span>.label.fill(<span class="number">0</span>);
<span data-nosnippet>539</span>            <span class="self">self</span>.bestedge.fill(!<span class="number">0</span>);
<span data-nosnippet>540</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>541</span>                <span class="self">self</span>.blossombestedges[b].clear();
<span data-nosnippet>542</span>            }
<span data-nosnippet>543</span>            <span class="self">self</span>.allowedge.fill(<span class="bool-val">false</span>);
<span data-nosnippet>544</span>            <span class="self">self</span>.queue.clear();
<span data-nosnippet>545</span>            <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>546</span>                <span class="kw">if </span><span class="self">self</span>.mate[v] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>{
<span data-nosnippet>547</span>                    <span class="self">self</span>.assign_label(v, <span class="number">1</span>, !<span class="number">0</span>);
<span data-nosnippet>548</span>                }
<span data-nosnippet>549</span>            }
<span data-nosnippet>550</span>            <span class="kw">let </span><span class="kw-2">mut </span>augmented = <span class="bool-val">false</span>;
<span data-nosnippet>551</span>            <span class="kw">loop </span>{
<span data-nosnippet>552</span>                <span class="kw">while let </span><span class="prelude-val">Some</span>(v) = <span class="self">self</span>.queue.pop() {
<span data-nosnippet>553</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] != <span class="number">1 </span>{
<span data-nosnippet>554</span>                        <span class="kw">continue</span>;
<span data-nosnippet>555</span>                    }
<span data-nosnippet>556</span>                    <span class="kw">let </span>neigh = <span class="self">self</span>.neighbend[v].clone();
<span data-nosnippet>557</span>                    <span class="kw">for </span>p <span class="kw">in </span>neigh {
<span data-nosnippet>558</span>                        <span class="kw">let </span>k = p / <span class="number">2</span>;
<span data-nosnippet>559</span>                        <span class="kw">let </span>w = <span class="self">self</span>.endpoint[p];
<span data-nosnippet>560</span>                        <span class="kw">if </span><span class="self">self</span>.inblossom[v] == <span class="self">self</span>.inblossom[w] {
<span data-nosnippet>561</span>                            <span class="kw">continue</span>;
<span data-nosnippet>562</span>                        }
<span data-nosnippet>563</span>                        <span class="kw">let </span><span class="kw-2">mut </span>kslack = <span class="number">0i64</span>;
<span data-nosnippet>564</span>                        <span class="kw">if </span>!<span class="self">self</span>.allowedge[k] {
<span data-nosnippet>565</span>                            kslack = <span class="self">self</span>.slack(k);
<span data-nosnippet>566</span>                            <span class="kw">if </span>kslack &lt;= <span class="number">0 </span>{
<span data-nosnippet>567</span>                                <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>568</span>                            }
<span data-nosnippet>569</span>                        }
<span data-nosnippet>570</span>                        <span class="kw">if </span><span class="self">self</span>.allowedge[k] {
<span data-nosnippet>571</span>                            <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">0 </span>{
<span data-nosnippet>572</span>                                <span class="self">self</span>.assign_label(w, <span class="number">2</span>, p ^ <span class="number">1</span>);
<span data-nosnippet>573</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>574</span>                                <span class="kw">let </span>base = <span class="self">self</span>.scan_blossom(v, w);
<span data-nosnippet>575</span>                                <span class="kw">if </span><span class="macro">base !</span>= !<span class="number">0 </span>{
<span data-nosnippet>576</span>                                    <span class="self">self</span>.add_blossom(base, k);
<span data-nosnippet>577</span>                                } <span class="kw">else </span>{
<span data-nosnippet>578</span>                                    <span class="self">self</span>.<span class="highlight focus">augment_matching</span>(k);
<span data-nosnippet>579</span>                                    augmented = <span class="bool-val">true</span>;
<span data-nosnippet>580</span>                                    <span class="kw">break</span>;
<span data-nosnippet>581</span>                                }
<span data-nosnippet>582</span>                            } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0 </span>{
<span data-nosnippet>583</span>                                <span class="self">self</span>.label[w] = <span class="number">2</span>;
<span data-nosnippet>584</span>                                <span class="self">self</span>.labelend[w] = p ^ <span class="number">1</span>;
<span data-nosnippet>585</span>                            }
<span data-nosnippet>586</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[w]] == <span class="number">1 </span>{
<span data-nosnippet>587</span>                            <span class="kw">let </span>b = <span class="self">self</span>.inblossom[v];
<span data-nosnippet>588</span>                            <span class="kw">if </span><span class="self">self</span>.bestedge[b] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]) {
<span data-nosnippet>589</span>                                <span class="self">self</span>.bestedge[b] = k;
<span data-nosnippet>590</span>                            }
<span data-nosnippet>591</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[w] == <span class="number">0
<span data-nosnippet>592</span>                            </span>&amp;&amp; (<span class="self">self</span>.bestedge[w] == !<span class="number">0 </span>|| kslack &lt; <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[w]))
<span data-nosnippet>593</span>                        {
<span data-nosnippet>594</span>                            <span class="self">self</span>.bestedge[w] = k;
<span data-nosnippet>595</span>                        }
<span data-nosnippet>596</span>                    }
<span data-nosnippet>597</span>                    <span class="kw">if </span>augmented {
<span data-nosnippet>598</span>                        <span class="kw">break</span>;
<span data-nosnippet>599</span>                    }
<span data-nosnippet>600</span>                }
<span data-nosnippet>601</span>                <span class="kw">if </span>augmented {
<span data-nosnippet>602</span>                    <span class="kw">break</span>;
<span data-nosnippet>603</span>                }
<span data-nosnippet>604</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltatype = -<span class="number">1</span>;
<span data-nosnippet>605</span>                <span class="kw">let </span><span class="kw-2">mut </span>delta = <span class="number">0i64</span>;
<span data-nosnippet>606</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltaedge = !<span class="number">0</span>;
<span data-nosnippet>607</span>                <span class="kw">let </span><span class="kw-2">mut </span>deltablossom = !<span class="number">0</span>;
<span data-nosnippet>608</span>                <span class="kw">if </span>!maxcardinality {
<span data-nosnippet>609</span>                    deltatype = <span class="number">1</span>;
<span data-nosnippet>610</span>                    delta = <span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().cloned().min().unwrap_or(<span class="number">0</span>);
<span data-nosnippet>611</span>                }
<span data-nosnippet>612</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>613</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">0 </span>&amp;&amp; <span class="self">self</span>.bestedge[v] != !<span class="number">0 </span>{
<span data-nosnippet>614</span>                        <span class="kw">let </span>d = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[v]);
<span data-nosnippet>615</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>616</span>                            delta = d;
<span data-nosnippet>617</span>                            deltatype = <span class="number">2</span>;
<span data-nosnippet>618</span>                            deltaedge = <span class="self">self</span>.bestedge[v];
<span data-nosnippet>619</span>                        }
<span data-nosnippet>620</span>                    }
<span data-nosnippet>621</span>                }
<span data-nosnippet>622</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="number">0</span>..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>623</span>                    <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1 </span>&amp;&amp; <span class="self">self</span>.bestedge[b] != !<span class="number">0 </span>{
<span data-nosnippet>624</span>                        <span class="kw">let </span>kslack = <span class="self">self</span>.slack(<span class="self">self</span>.bestedge[b]);
<span data-nosnippet>625</span>                        <span class="kw">let </span>d = kslack / <span class="number">2</span>;
<span data-nosnippet>626</span>                        <span class="kw">if </span>deltatype == -<span class="number">1 </span>|| d &lt; delta {
<span data-nosnippet>627</span>                            delta = d;
<span data-nosnippet>628</span>                            deltatype = <span class="number">3</span>;
<span data-nosnippet>629</span>                            deltaedge = <span class="self">self</span>.bestedge[b];
<span data-nosnippet>630</span>                        }
<span data-nosnippet>631</span>                    }
<span data-nosnippet>632</span>                }
<span data-nosnippet>633</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>634</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>635</span>                        </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>636</span>                        </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">2
<span data-nosnippet>637</span>                        </span>&amp;&amp; (deltatype == -<span class="number">1 </span>|| <span class="self">self</span>.dualvar[b] &lt; delta)
<span data-nosnippet>638</span>                    {
<span data-nosnippet>639</span>                        delta = <span class="self">self</span>.dualvar[b];
<span data-nosnippet>640</span>                        deltatype = <span class="number">4</span>;
<span data-nosnippet>641</span>                        deltablossom = b;
<span data-nosnippet>642</span>                    }
<span data-nosnippet>643</span>                }
<span data-nosnippet>644</span>                <span class="kw">if </span>deltatype == -<span class="number">1 </span>{
<span data-nosnippet>645</span>                    <span class="kw">if </span>maxcardinality {
<span data-nosnippet>646</span>                        deltatype = <span class="number">1</span>;
<span data-nosnippet>647</span>                        delta = <span class="number">0</span>.max(<span class="kw-2">*</span><span class="self">self</span>.dualvar[<span class="number">0</span>..<span class="self">self</span>.n].iter().min().unwrap_or(<span class="kw-2">&amp;</span><span class="number">0</span>));
<span data-nosnippet>648</span>                    } <span class="kw">else </span>{
<span data-nosnippet>649</span>                        <span class="kw">break</span>;
<span data-nosnippet>650</span>                    }
<span data-nosnippet>651</span>                }
<span data-nosnippet>652</span>                <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>653</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">1 </span>{
<span data-nosnippet>654</span>                        <span class="self">self</span>.dualvar[v] -= delta;
<span data-nosnippet>655</span>                    } <span class="kw">else if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[v]] == <span class="number">2 </span>{
<span data-nosnippet>656</span>                        <span class="self">self</span>.dualvar[v] += delta;
<span data-nosnippet>657</span>                    }
<span data-nosnippet>658</span>                }
<span data-nosnippet>659</span>                <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>660</span>                    <span class="kw">if </span><span class="self">self</span>.blossombase[b] != !<span class="number">0 </span>&amp;&amp; <span class="self">self</span>.blossomparent[b] == !<span class="number">0 </span>{
<span data-nosnippet>661</span>                        <span class="kw">if </span><span class="self">self</span>.label[b] == <span class="number">1 </span>{
<span data-nosnippet>662</span>                            <span class="self">self</span>.dualvar[b] += delta;
<span data-nosnippet>663</span>                        } <span class="kw">else if </span><span class="self">self</span>.label[b] == <span class="number">2 </span>{
<span data-nosnippet>664</span>                            <span class="self">self</span>.dualvar[b] -= delta;
<span data-nosnippet>665</span>                        }
<span data-nosnippet>666</span>                    }
<span data-nosnippet>667</span>                }
<span data-nosnippet>668</span>                <span class="kw">if </span>deltatype == <span class="number">1 </span>{
<span data-nosnippet>669</span>                    <span class="kw">break</span>;
<span data-nosnippet>670</span>                } <span class="kw">else if </span>deltatype == <span class="number">2 </span>{
<span data-nosnippet>671</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>672</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>673</span>                    <span class="kw">let </span><span class="kw-2">mut </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>674</span>                    <span class="kw">let </span><span class="kw-2">mut </span>j = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k + <span class="number">1</span>];
<span data-nosnippet>675</span>                    <span class="kw">if </span><span class="self">self</span>.label[<span class="self">self</span>.inblossom[i]] == <span class="number">0 </span>{
<span data-nosnippet>676</span>                        std::mem::swap(<span class="kw-2">&amp;mut </span>i, <span class="kw-2">&amp;mut </span>j);
<span data-nosnippet>677</span>                    }
<span data-nosnippet>678</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>679</span>                } <span class="kw">else if </span>deltatype == <span class="number">3 </span>{
<span data-nosnippet>680</span>                    <span class="kw">let </span>k = deltaedge;
<span data-nosnippet>681</span>                    <span class="self">self</span>.allowedge[k] = <span class="bool-val">true</span>;
<span data-nosnippet>682</span>                    <span class="kw">let </span>i = <span class="self">self</span>.endpoint[<span class="number">2 </span>* k];
<span data-nosnippet>683</span>                    <span class="self">self</span>.queue.push(i);
<span data-nosnippet>684</span>                } <span class="kw">else if </span>deltatype == <span class="number">4 </span>{
<span data-nosnippet>685</span>                    <span class="self">self</span>.expand_blossom(deltablossom, <span class="bool-val">false</span>);
<span data-nosnippet>686</span>                }
<span data-nosnippet>687</span>            }
<span data-nosnippet>688</span>            <span class="kw">if </span>!augmented {
<span data-nosnippet>689</span>                <span class="kw">break</span>;
<span data-nosnippet>690</span>            }
<span data-nosnippet>691</span>            <span class="kw">for </span>b <span class="kw">in </span><span class="self">self</span>.n..<span class="number">2 </span>* <span class="self">self</span>.n {
<span data-nosnippet>692</span>                <span class="kw">if </span><span class="self">self</span>.blossomparent[b] == !<span class="number">0
<span data-nosnippet>693</span>                    </span>&amp;&amp; <span class="self">self</span>.blossombase[b] != !<span class="number">0
<span data-nosnippet>694</span>                    </span>&amp;&amp; <span class="self">self</span>.label[b] == <span class="number">1
<span data-nosnippet>695</span>                    </span>&amp;&amp; <span class="self">self</span>.dualvar[b] == <span class="number">0
<span data-nosnippet>696</span>                </span>{
<span data-nosnippet>697</span>                    <span class="self">self</span>.expand_blossom(b, <span class="bool-val">true</span>);
<span data-nosnippet>698</span>                }
<span data-nosnippet>699</span>            }
<span data-nosnippet>700</span>        }
<span data-nosnippet>701</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..<span class="self">self</span>.n {
<span data-nosnippet>702</span>            <span class="kw">if </span><span class="self">self</span>.mate[v] != !<span class="number">0 </span>{
<span data-nosnippet>703</span>                <span class="self">self</span>.mate[v] = <span class="self">self</span>.endpoint[<span class="self">self</span>.mate[v]];
<span data-nosnippet>704</span>            }
<span data-nosnippet>705</span>        }
<span data-nosnippet>706</span>    }</code></pre></div></div></div></details><details class="toggle method-toggle" open><summary><section id="method.solve" class="method"><a class="src rightside" href="../../../src/competitive/graph/general_weighted_matching.rs.html#536-706">Source</a><h4 class="code-header">fn <a href="#method.solve" class="fn">solve</a>(&amp;mut self, maxcardinality: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>)</h4></section></summary><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples-11"><a href="#scraped-examples-11">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[33,33],&#34;../../../src/competitive/graph/general_weighted_matching.rs.html#83&#34;,&#34;line 83&#34;]]"><div class="scraped-example-title">crates/competitive/src/graph/general_weighted_matching.rs (<a href="../../../src/competitive/graph/general_weighted_matching.rs.html#83">line 83</a>)</div><div class="example-wrap digits-2"><pre class="rust"><code><span data-nosnippet>50</span>    <span class="kw">fn </span>compute(<span class="kw-2">&amp;mut </span><span class="self">self</span>) {
<span data-nosnippet>51</span>        <span class="kw">if </span><span class="self">self</span>.<span class="macro">matching_weight !</span>= NEG_INF {
<span data-nosnippet>52</span>            <span class="kw">return</span>;
<span data-nosnippet>53</span>        }
<span data-nosnippet>54</span>        <span class="kw">let </span>n = <span class="self">self</span>.size;
<span data-nosnippet>55</span>        <span class="kw">if </span>n == <span class="number">0 </span>{
<span data-nosnippet>56</span>            <span class="self">self</span>.matching_weight = <span class="number">0</span>;
<span data-nosnippet>57</span>            <span class="kw">return</span>;
<span data-nosnippet>58</span>        }
<span data-nosnippet>59</span>        <span class="kw">let </span><span class="kw-2">mut </span>edges = Vec::new();
<span data-nosnippet>60</span>        <span class="kw">let </span><span class="kw-2">mut </span>weights = Vec::new();
<span data-nosnippet>61</span>        <span class="kw">let </span><span class="kw-2">mut </span>neighbend = <span class="macro">vec!</span>[Vec::new(); n];
<span data-nosnippet>62</span>        <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..n {
<span data-nosnippet>63</span>            <span class="kw">for </span>j <span class="kw">in </span>i + <span class="number">1</span>..n {
<span data-nosnippet>64</span>                <span class="kw">let </span>w = <span class="self">self</span>.weight[i][j];
<span data-nosnippet>65</span>                <span class="kw">if </span>w == NEG_INF {
<span data-nosnippet>66</span>                    <span class="kw">continue</span>;
<span data-nosnippet>67</span>                }
<span data-nosnippet>68</span>                <span class="kw">let </span>k = weights.len();
<span data-nosnippet>69</span>                weights.push(w);
<span data-nosnippet>70</span>                edges.push(i);
<span data-nosnippet>71</span>                edges.push(j);
<span data-nosnippet>72</span>                neighbend[i].push(<span class="number">2 </span>* k + <span class="number">1</span>);
<span data-nosnippet>73</span>                neighbend[j].push(<span class="number">2 </span>* k);
<span data-nosnippet>74</span>            }
<span data-nosnippet>75</span>        }
<span data-nosnippet>76</span>        <span class="kw">let </span>m = weights.len();
<span data-nosnippet>77</span>        <span class="kw">if </span>m == <span class="number">0 </span>{
<span data-nosnippet>78</span>            <span class="self">self</span>.mate.fill(!<span class="number">0</span>);
<span data-nosnippet>79</span>            <span class="self">self</span>.matching_weight = <span class="number">0</span>;
<span data-nosnippet>80</span>            <span class="kw">return</span>;
<span data-nosnippet>81</span>        }
<span data-nosnippet>82</span>        <span class="kw">let </span><span class="kw-2">mut </span>blossom = BlossomMatching::new(n, edges, weights, neighbend);
<span data-nosnippet>83</span>        blossom.<span class="highlight focus">solve</span>(<span class="bool-val">false</span>);
<span data-nosnippet>84</span>        <span class="self">self</span>.mate.fill(!<span class="number">0</span>);
<span data-nosnippet>85</span>        <span class="kw">let </span><span class="kw-2">mut </span>total = <span class="number">0i64</span>;
<span data-nosnippet>86</span>        <span class="kw">for </span>v <span class="kw">in </span><span class="number">0</span>..n {
<span data-nosnippet>87</span>            <span class="kw">let </span>u = blossom.mate[v];
<span data-nosnippet>88</span>            <span class="kw">if </span><span class="macro">u !</span>= !<span class="number">0 </span>&amp;&amp; v &lt; u {
<span data-nosnippet>89</span>                <span class="self">self</span>.mate[v] = u;
<span data-nosnippet>90</span>                <span class="self">self</span>.mate[u] = v;
<span data-nosnippet>91</span>                total += <span class="self">self</span>.weight[v][u];
<span data-nosnippet>92</span>            }
<span data-nosnippet>93</span>        }
<span data-nosnippet>94</span>        <span class="self">self</span>.matching_weight = total;
<span data-nosnippet>95</span>    }</code></pre></div></div></div></details></div></details></div><h2 id="synthetic-implementations" class="section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor">§</a></h2><div id="synthetic-implementations-list"><section id="impl-Freeze-for-BlossomMatching" class="impl"><a href="#impl-Freeze-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Freeze.html" title="trait core::marker::Freeze">Freeze</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section><section id="impl-RefUnwindSafe-for-BlossomMatching" class="impl"><a href="#impl-RefUnwindSafe-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section><section id="impl-Send-for-BlossomMatching" class="impl"><a href="#impl-Send-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section><section id="impl-Sync-for-BlossomMatching" class="impl"><a href="#impl-Sync-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section><section id="impl-Unpin-for-BlossomMatching" class="impl"><a href="#impl-Unpin-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section><section id="impl-UnwindSafe-for-BlossomMatching" class="impl"><a href="#impl-UnwindSafe-for-BlossomMatching" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.BlossomMatching.html" title="struct competitive::graph::general_weighted_matching::BlossomMatching">BlossomMatching</a></h3></section></div><h2 id="blanket-implementations" class="section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor">§</a></h2><div id="blanket-implementations-list"><details class="toggle implementors-toggle"><summary><section id="impl-Any-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#138">Source</a><a href="#impl-Any-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T<div class="where">where
    T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#139">Source</a><a href="#method.type_id" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id" class="fn">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#212">Source</a><a href="#impl-Borrow%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#214">Source</a><a href="#method.borrow" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#221">Source</a><a href="#impl-BorrowMut%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#222">Source</a><a href="#method.borrow_mut" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fn">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut T</a></h4></section></summary><div class='docblock'>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#785">Source</a><a href="#impl-From%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#788">Source</a><a href="#method.from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>Returns the argument unchanged.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#767-769">Source</a><a href="#impl-Into%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#777">Source</a><a href="#method.into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html#tymethod.into" class="fn">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>Calls <code>U::from(self)</code>.</p>
<p>That is, this conversion is whatever the implementation of
<code><a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for U</code> chooses to do.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#827-829">Source</a><a href="#impl-TryFrom%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#831">Source</a><a href="#associatedtype.Error-1" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#834">Source</a><a href="#method.try_from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#811-813">Source</a><a href="#impl-TryInto%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#815">Source</a><a href="#associatedtype.Error" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#818">Source</a><a href="#method.try_into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#tymethod.try_into" class="fn">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details></div></section></div></main></body></html>
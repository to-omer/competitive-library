<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `ntt` fn in crate `competitive`."><title>ntt in competitive::math::number_theoretic_transform - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-80aa586b.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="competitive" data-themes="" data-resource-suffix="" data-rustdoc-version="1.94.0-nightly (f794a0873 2025-12-17)" data-channel="nightly" data-search-js="search-9e2438ea.js" data-stringdex-js="stringdex-a3946164.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-3e30299d.js"></script><script defer src="../../../static.files/scrape-examples-2bbcccac.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-ffcac47a.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ]
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const parser = new DOMParser();
    const parse = s => parser.parseFromString(s, "text/html").body.firstChild;

    const addArchiveLinkSetting = () => {
      const settings = document.querySelector("#settings .settings");
      if (!settings) return;
      if (document.getElementById("generate-hidden-archive-link")) return;

      const checked = localStorage.getItem("generate-hidden-archive-link") === "true";
      const archiveLinkSetting = parse(`<div class="setting-line"><label class="setting-check"><input type="checkbox" id="generate-hidden-archive-link" ${checked ? "checked" : ""} /><span>Generate hidden archive link</span></label></div>`);
      settings.appendChild(archiveLinkSetting);
      document.getElementById("generate-hidden-archive-link").addEventListener("change", e => {
        if (e.target.checked) {
          localStorage.setItem("generate-hidden-archive-link", "true");
        } else {
          localStorage.removeItem("generate-hidden-archive-link");
        }
      });
    };
    addArchiveLinkSetting();
    const settingsMenu = document.querySelector("#settings-menu a");
    settingsMenu?.addEventListener("click", addArchiveLinkSetting);

    const addArchiveLink = () => {
      if (localStorage.getItem("generate-hidden-archive-link") !== "true") return;
      const subHeading = document.querySelector("#main-content .main-heading .sub-heading");
      const itemName = document.querySelector("#main-content .main-heading h1 span")?.textContent;
      const isCompetitive = document.querySelector("#main-content .main-heading .rustdoc-breadcrumbs a")?.textContent?.startsWith("competitive");
      if (!itemName || !isCompetitive) return;
      const archiveLink = parse(`<a class="src" href="https://github.com/search?q=repo%3Ato-omer%2Fcompetitive_archive+${itemName}&type=code">Archives</a>`);
      subHeading.appendChild(archiveLink);
    };
    addArchiveLink();
  });
</script>

</head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">ntt</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../competitive/index.html">competitive</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"><h2><a href="index.html">In competitive::<wbr>math::<wbr>number_<wbr>theoretic_<wbr>transform</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">competitive</a>::<wbr><a href="../index.html">math</a>::<wbr><a href="index.html">number_theoretic_transform</a></div><h1>Function <span class="fn">ntt</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/competitive/math/number_theoretic_transform.rs.html#147-197">Source</a> </span></div><pre class="rust item-decl"><code>fn ntt&lt;M&gt;(a: &amp;mut [<a class="struct" href="../../num/struct.MInt.html" title="struct competitive::num::MInt">MInt</a>&lt;M&gt;])<div class="where">where
    M: <a class="trait" href="trait.Montgomery32NttModulus.html" title="trait competitive::math::number_theoretic_transform::Montgomery32NttModulus">Montgomery32NttModulus</a>,</div></code></pre><div class="docblock scraped-example-list"><span></span><h5 id="scraped-examples"><a href="#scraped-examples">Examples found in repository</a><a class="scrape-help" href="../../../scrape-examples-help.html">?</a></h5><div class="scraped-example" data-locs="[[[2,2],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#335&#34;,&#34;line 335&#34;],[[88,88],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#421&#34;,&#34;line 421&#34;],[[89,89],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#422&#34;,&#34;line 422&#34;],[[90,90],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#423&#34;,&#34;line 423&#34;],[[169,169],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#502&#34;,&#34;line 502&#34;],[[170,170],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#503&#34;,&#34;line 503&#34;],[[171,171],&#34;../../../src/competitive/math/number_theoretic_transform.rs.html#504&#34;,&#34;line 504&#34;]]"><div class="scraped-example-title">crates/competitive/src/math/number_theoretic_transform.rs (<a href="../../../src/competitive/math/number_theoretic_transform.rs.html#335">line 335</a>)</div><div class="example-wrap digits-3"><pre class="rust"><code><span data-nosnippet>333</span>    <span class="kw">fn </span>transform(<span class="kw-2">mut </span>t: <span class="self">Self</span>::T, len: usize) -&gt; <span class="self">Self</span>::F {
<span data-nosnippet>334</span>        t.resize_with(len.max(<span class="number">1</span>).next_power_of_two(), Zero::zero);
<span data-nosnippet>335</span>        <span class="highlight focus">ntt</span>(<span class="kw-2">&amp;mut </span>t);
<span data-nosnippet>336</span>        t
<span data-nosnippet>337</span>    }
<span data-nosnippet>338</span>    <span class="kw">fn </span>inverse_transform(<span class="kw-2">mut </span>f: <span class="self">Self</span>::F, len: usize) -&gt; <span class="self">Self</span>::T {
<span data-nosnippet>339</span>        intt(<span class="kw-2">&amp;mut </span>f);
<span data-nosnippet>340</span>        f.truncate(len);
<span data-nosnippet>341</span>        <span class="kw">let </span>inv = MInt::from(len.max(<span class="number">1</span>).next_power_of_two() <span class="kw">as </span>u32).inv();
<span data-nosnippet>342</span>        <span class="kw">for </span>f <span class="kw">in </span>f.iter_mut() {
<span data-nosnippet>343</span>            <span class="kw-2">*</span>f <span class="kw-2">*</span>= inv;
<span data-nosnippet>344</span>        }
<span data-nosnippet>345</span>        f
<span data-nosnippet>346</span>    }
<span data-nosnippet>347</span>    <span class="kw">fn </span>multiply(f: <span class="kw-2">&amp;mut </span><span class="self">Self</span>::F, g: <span class="kw-2">&amp;</span><span class="self">Self</span>::F) {
<span data-nosnippet>348</span>        <span class="macro">assert_eq!</span>(f.len(), g.len());
<span data-nosnippet>349</span>        <span class="kw">for </span>(f, g) <span class="kw">in </span>f.iter_mut().zip(g.iter()) {
<span data-nosnippet>350</span>            <span class="kw-2">*</span>f <span class="kw-2">*</span>= <span class="kw-2">*</span>g;
<span data-nosnippet>351</span>        }
<span data-nosnippet>352</span>    }
<span data-nosnippet>353</span>    <span class="kw">fn </span>convolve(<span class="kw-2">mut </span>a: <span class="self">Self</span>::T, <span class="kw-2">mut </span>b: <span class="self">Self</span>::T) -&gt; <span class="self">Self</span>::T {
<span data-nosnippet>354</span>        <span class="kw">if </span><span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a).max(<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)) &lt;= <span class="number">100 </span>{
<span data-nosnippet>355</span>            <span class="kw">return </span>convolve_karatsuba(<span class="kw-2">&amp;</span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>356</span>        }
<span data-nosnippet>357</span>        <span class="kw">if </span><span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a).min(<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)) &lt;= <span class="number">60 </span>{
<span data-nosnippet>358</span>            <span class="kw">return </span>convolve_naive(<span class="kw-2">&amp;</span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>359</span>        }
<span data-nosnippet>360</span>        <span class="kw">let </span>len = (<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a) + <span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)).saturating_sub(<span class="number">1</span>);
<span data-nosnippet>361</span>        <span class="kw">let </span>size = len.max(<span class="number">1</span>).next_power_of_two();
<span data-nosnippet>362</span>        <span class="kw">if </span>len &lt;= size / <span class="number">2 </span>+ <span class="number">2 </span>{
<span data-nosnippet>363</span>            <span class="kw">let </span>xa = a.pop().unwrap();
<span data-nosnippet>364</span>            <span class="kw">let </span>xb = b.pop().unwrap();
<span data-nosnippet>365</span>            <span class="kw">let </span><span class="kw-2">mut </span>c = <span class="macro">vec!</span>[MInt::&lt;M&gt;::zero(); len];
<span data-nosnippet>366</span>            <span class="kw-2">*</span>c.last_mut().unwrap() = xa * xb;
<span data-nosnippet>367</span>            <span class="kw">for </span>(a, c) <span class="kw">in </span>a.iter().zip(<span class="kw-2">&amp;mut </span>c[b.len()..]) {
<span data-nosnippet>368</span>                <span class="kw-2">*</span>c += <span class="kw-2">*</span><a href="#318">a</a> * xb;
<span data-nosnippet>369</span>            }
<span data-nosnippet>370</span>            <span class="kw">for </span>(b, c) <span class="kw">in </span>b.iter().zip(<span class="kw-2">&amp;mut </span>c[a.len()..]) {
<span data-nosnippet>371</span>                <span class="kw-2">*</span>c += <span class="kw-2">*</span>b * xa;
<span data-nosnippet>372</span>            }
<span data-nosnippet>373</span>            <span class="kw">let </span>d = <span class="self">Self</span>::convolve(a, b);
<span data-nosnippet>374</span>            <span class="kw">for </span>(d, c) <span class="kw">in </span>d.into_iter().zip(<span class="kw-2">&amp;mut </span>c) {
<span data-nosnippet>375</span>                <span class="kw-2">*</span>c += d;
<span data-nosnippet>376</span>            }
<span data-nosnippet>377</span>            <span class="kw">return </span>c;
<span data-nosnippet>378</span>        }
<span data-nosnippet>379</span>        <span class="kw">let </span>same = a == b;
<span data-nosnippet>380</span>        <span class="kw">let </span><span class="kw-2">mut </span>a = <span class="self">Self</span>::transform(a, len);
<span data-nosnippet>381</span>        <span class="kw">if </span>same {
<span data-nosnippet>382</span>            <span class="kw">for </span>a <span class="kw">in </span>a.iter_mut() {
<span data-nosnippet>383</span>                <span class="kw-2">*</span>a <span class="kw-2">*</span>= <span class="kw-2">*</span>a;
<span data-nosnippet>384</span>            }
<span data-nosnippet>385</span>        } <span class="kw">else </span>{
<span data-nosnippet>386</span>            <span class="kw">let </span>b = <span class="self">Self</span>::transform(b, len);
<span data-nosnippet>387</span>            <span class="self">Self</span>::multiply(<span class="kw-2">&amp;mut </span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>388</span>        }
<span data-nosnippet>389</span>        <span class="self">Self</span>::inverse_transform(a, len)
<span data-nosnippet>390</span>    }
<span data-nosnippet>391</span>}
<span data-nosnippet>392</span>
<span data-nosnippet>393</span><span class="kw">type </span>MVec&lt;M&gt; = Vec&lt;MInt&lt;M&gt;&gt;;
<span data-nosnippet>394</span><span class="kw">impl</span>&lt;M, N1, N2, N3&gt; ConvolveSteps <span class="kw">for </span>Convolve&lt;(M, (N1, N2, N3))&gt;
<span data-nosnippet>395</span><span class="kw">where
<span data-nosnippet>396</span>    </span>M: MIntConvert + MIntConvert&lt;u32&gt;,
<span data-nosnippet>397</span>    N1: Montgomery32NttModulus,
<span data-nosnippet>398</span>    N2: Montgomery32NttModulus,
<span data-nosnippet>399</span>    N3: Montgomery32NttModulus,
<span data-nosnippet>400</span>{
<span data-nosnippet>401</span>    <span class="kw">type </span>T = MVec&lt;M&gt;;
<span data-nosnippet>402</span>    <span class="kw">type </span>F = (MVec&lt;N1&gt;, MVec&lt;N2&gt;, MVec&lt;N3&gt;);
<span data-nosnippet>403</span>    <span class="kw">fn </span>length(t: <span class="kw-2">&amp;</span><span class="self">Self</span>::T) -&gt; usize {
<span data-nosnippet>404</span>        t.len()
<span data-nosnippet>405</span>    }
<span data-nosnippet>406</span>    <span class="kw">fn </span>transform(t: <span class="self">Self</span>::T, <a href="https://doc.rust-lang.org/nightly/core/ops/arith/trait.Add.html">len</a>: usize) -&gt; <span class="self">Self</span>::F {
<span data-nosnippet>407</span>        <span class="kw">let </span>npot = len.max(<span class="number">1</span>).next_power_of_two();
<span data-nosnippet>408</span>        <span class="kw">let </span><span class="kw-2">mut </span>f = (
<span data-nosnippet>409</span>            MVec::&lt;N1&gt;::with_capacity(npot),
<span data-nosnippet>410</span>            MVec::&lt;N2&gt;::with_capacity(npot),
<span data-nosnippet>411</span>            MVec::&lt;N3&gt;::with_capacity(npot),
<span data-nosnippet>412</span>        );
<span data-nosnippet>413</span>        <span class="kw">for </span>t <span class="kw">in </span>t {
<span data-nosnippet>414</span>            f.<span class="number">0</span>.push(&lt;M <span class="kw">as </span>MIntConvert&lt;u32&gt;&gt;::into(t.inner()).into());
<span data-nosnippet>415</span>            f.<span class="number">1</span>.push(&lt;M <span class="kw">as </span>MIntConvert&lt;u32&gt;&gt;::into(t.inner()).into());
<span data-nosnippet>416</span>            f.<span class="number">2</span>.push(&lt;M <span class="kw">as </span>MIntConvert&lt;u32&gt;&gt;::into(t.inner()).into());
<span data-nosnippet>417</span>        }
<span data-nosnippet>418</span>        f.<span class="number">0</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>419</span>        f.<span class="number">1</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>420</span>        f.<span class="number">2</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>421</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">0</span>);
<span data-nosnippet>422</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">1</span>);
<span data-nosnippet>423</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">2</span>);
<span data-nosnippet>424</span>        f
<span data-nosnippet>425</span>    }
<span data-nosnippet>426</span>    <span class="kw">fn </span>inverse_transform(f: <span class="self">Self</span>::F, len: usize) -&gt; <span class="self">Self</span>::T {
<span data-nosnippet>427</span>        <span class="kw">let </span>t1 = MInt::&lt;N2&gt;::new(N1::get_mod()).inv();
<span data-nosnippet>428</span>        <span class="kw">let </span>m1 = MInt::&lt;M&gt;::from(N1::get_mod());
<span data-nosnippet>429</span>        <span class="kw">let </span>m1_3 = MInt::&lt;N3&gt;::new(N1::get_mod());
<span data-nosnippet>430</span>        <span class="kw">let </span>t2 = (m1_3 * MInt::&lt;N3&gt;::new(N2::get_mod())).inv();
<span data-nosnippet>431</span>        <span class="kw">let </span>m2 = m1 * MInt::&lt;M&gt;::from(N2::get_mod());
<span data-nosnippet>432</span>        Convolve::&lt;N1&gt;::inverse_transform(f.<span class="number">0</span>, len)
<span data-nosnippet>433</span>            .into_iter()
<span data-nosnippet>434</span>            .zip(Convolve::&lt;N2&gt;::inverse_transform(f.<span class="number">1</span>, len))
<span data-nosnippet>435</span>            .zip(Convolve::&lt;N3&gt;::inverse_transform(f.<span class="number">2</span>, len))
<span data-nosnippet>436</span>            .map(|((c1, c2), c3)| {
<span data-nosnippet>437</span>                <span class="kw">let </span>d1 = c1.inner();
<span data-nosnippet>438</span>                <span class="kw">let </span>d2 = ((c2 - MInt::&lt;N2&gt;::from(d1)) * t1).inner();
<span data-nosnippet>439</span>                <span class="kw">let </span>x = MInt::&lt;N3&gt;::new(d1) + MInt::&lt;N3&gt;::new(d2) * m1_3;
<span data-nosnippet>440</span>                <span class="kw">let </span>d3 = ((c3 - <a href="#409">x</a>) * t2).inner();
<span data-nosnippet>441</span>                MInt::&lt;M&gt;::from(d1) + MInt::&lt;M&gt;::from(d2) * m1 + MInt::&lt;M&gt;::from(d3) * m2
<span data-nosnippet>442</span>            })
<span data-nosnippet>443</span>            .collect()
<span data-nosnippet>444</span>    }
<span data-nosnippet>445</span>    <span class="kw">fn </span>multiply(f: <span class="kw-2">&amp;mut </span><span class="self">Self</span>::F, g: <span class="kw-2">&amp;</span><span class="self">Self</span>::F) {
<span data-nosnippet>446</span>        <span class="macro">assert_eq!</span>(f.<span class="number">0</span>.len(), g.<span class="number">0</span>.len());
<span data-nosnippet>447</span>        <span class="macro">assert_eq!</span>(f.<span class="number">1</span>.len(), g.<span class="number">1</span>.len());
<span data-nosnippet>448</span>        <span class="macro">assert_eq!</span>(f.<span class="number">2</span>.len(), g.<span class="number">2</span>.len());
<span data-nosnippet>449</span>        <span class="kw">for </span>(f, g) <span class="kw">in </span>f.<span class="number">0</span>.iter_mut().zip(g.<span class="number">0</span>.iter()) {
<span data-nosnippet>450</span>            <span class="kw-2">*</span>f <span class="kw-2">*</span>= <span class="kw-2">*</span>g;
<span data-nosnippet>451</span>        }
<span data-nosnippet>452</span>        <span class="kw">for </span>(f, g) <span class="kw">in </span>f.<span class="number">1</span>.iter_mut().zip(g.<span class="number">1</span>.iter()) {
<span data-nosnippet>453</span>            <span class="kw-2">*</span>f <span class="kw-2">*</span>= <span class="kw-2">*</span>g;
<span data-nosnippet>454</span>        }
<span data-nosnippet>455</span>        <span class="kw">for </span>(f, g) <span class="kw">in </span>f.<span class="number">2</span>.iter_mut().zip(g.<span class="number">2</span>.iter()) {
<span data-nosnippet>456</span>            <span class="kw-2">*</span>f <span class="kw-2">*</span>= <span class="kw-2">*</span>g;
<span data-nosnippet>457</span>        }
<span data-nosnippet>458</span>    }
<span data-nosnippet>459</span>    <span class="kw">fn </span>convolve(a: <span class="self">Self</span>::T, b: <span class="self">Self</span>::T) -&gt; <span class="self">Self</span>::T {
<span data-nosnippet>460</span>        <span class="kw">if </span><span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a).<a href="https://doc.rust-lang.org/nightly/core/ops/arith/trait.Add.html">max</a>(<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)) &lt;= <span class="number">300 </span>{
<span data-nosnippet>461</span>            <span class="kw">return </span>convolve_karatsuba(<span class="kw-2">&amp;</span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>462</span>        }
<span data-nosnippet>463</span>        <span class="kw">if </span><span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a).min(<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)) &lt;= <span class="number">60 </span>{
<span data-nosnippet>464</span>            <span class="kw">return </span>convolve_naive(<span class="kw-2">&amp;</span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>465</span>        }
<span data-nosnippet>466</span>        <span class="kw">let </span>len = (<span class="self">Self</span>::length(<span class="kw-2">&amp;</span>a) + <span class="self">Self</span>::length(<span class="kw-2">&amp;</span>b)).saturating_sub(<span class="number">1</span>);
<span data-nosnippet>467</span>        <span class="kw">let </span><span class="kw-2">mut </span>a = <span class="self">Self</span>::transform(a, len);
<span data-nosnippet>468</span>        <span class="kw">let </span>b = <span class="self">Self</span>::transform(b, len);
<span data-nosnippet>469</span>        <span class="self">Self</span>::multiply(<span class="kw-2">&amp;mut </span>a, <span class="kw-2">&amp;</span>b);
<span data-nosnippet>470</span>        <span class="self">Self</span>::inverse_transform(a, len)
<span data-nosnippet>471</span>    }
<span data-nosnippet>472</span>}
<span data-nosnippet>473</span>
<span data-nosnippet>474</span><span class="kw">impl</span>&lt;N1, N2, N3&gt; ConvolveSteps <span class="kw">for </span>Convolve&lt;(u64, (N1, N2, N3))&gt;
<span data-nosnippet>475</span><span class="kw">where
<span data-nosnippet>476</span>    </span>N1: Montgomery32NttModulus,
<span data-nosnippet>477</span>    N2: Montgomery32NttModulus,
<span data-nosnippet>478</span>    N3: Montgomery32NttModulus,
<span data-nosnippet>479</span>{
<span data-nosnippet>480</span>    <span class="kw">type </span>T = Vec&lt;u64&gt;;
<span data-nosnippet>481</span>    <span class="kw">type </span>F = (MVec&lt;N1&gt;, MVec&lt;N2&gt;, MVec&lt;N3&gt;);
<span data-nosnippet>482</span>
<span data-nosnippet>483</span>    <span class="kw">fn </span>length(t: <span class="kw-2">&amp;</span><span class="self">Self</span>::T) -&gt; usize {
<span data-nosnippet>484</span>        t.len()
<span data-nosnippet>485</span>    }
<span data-nosnippet>486</span>
<span data-nosnippet>487</span>    <span class="kw">fn </span>transform(t: <span class="self">Self</span>::T, len: usize) -&gt; <span class="self">Self</span>::F {
<span data-nosnippet>488</span>        <span class="kw">let </span>npot = len.max(<span class="number">1</span>).next_power_of_two();
<span data-nosnippet>489</span>        <span class="kw">let </span><span class="kw-2">mut </span>f = (
<span data-nosnippet>490</span>            MVec::&lt;N1&gt;::with_capacity(npot),
<span data-nosnippet>491</span>            MVec::&lt;N2&gt;::with_capacity(npot),
<span data-nosnippet>492</span>            MVec::&lt;N3&gt;::with_capacity(npot),
<span data-nosnippet>493</span>        );
<span data-nosnippet>494</span>        <span class="kw">for </span>t <span class="kw">in </span>t {
<span data-nosnippet>495</span>            f.<span class="number">0</span>.push(t.into());
<span data-nosnippet>496</span>            f.<span class="number">1</span>.push(t.into());
<span data-nosnippet>497</span>            f.<span class="number">2</span>.push(t.into());
<span data-nosnippet>498</span>        }
<span data-nosnippet>499</span>        f.<span class="number">0</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>500</span>        f.<span class="number">1</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>501</span>        f.<span class="number">2</span>.resize_with(npot, Zero::zero);
<span data-nosnippet>502</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">0</span>);
<span data-nosnippet>503</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">1</span>);
<span data-nosnippet>504</span>        <span class="highlight">ntt</span>(<span class="kw-2">&amp;mut </span>f.<span class="number">2</span>);
<span data-nosnippet>505</span>        f
<span data-nosnippet>506</span>    }</code></pre></div></div></div></section></div></main></body></html>